var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},function(e){BOLDGRID.EDITOR.Controls={$panel:null,$menu:null,controls:[],$container:null,init:function(e){this.$container=e,this.$container.find("body").css("marginTop","50px"),this.$menu=BOLDGRID.EDITOR.Menu.init(),this.$panel=BOLDGRID.EDITOR.Panel.init(),this.bindEvents(),this.setupControls()},registerControl:function(e){this.controls.push(e)},bindEvents:function(){this.onEditibleClick()},onEditibleClick:function(){var t=this;this.$container.on("click",function(e){!e.boldgrid||!e.boldgrid.menuItem}),this.$container.on("mouseup",function(e){t.$menu.items=[]}),this.$container.on("click",function(n){t.$menu.find("li").hide(),t.$menu.items.length?t.$menu.show():(t.$menu.hide(),BOLDGRID.EDITOR.Panel.closePanel()),e.each(t.$menu.items,function(){t.$menu.find('[data-action="menu-'+this+'"]').show(),BOLDGRID.EDITOR.Menu.reactivateMenu()})})},setupControls:function(){var t=this,n=function(e,t){return e.priority<t.priority?-1:e.priority>t.priority?1:0};this.controls.sort(n),e.each(this.controls,function(){t.setupControl(this)})},setupControl:function(e){this.bindControlHandler(e),BOLDGRID.EDITOR.Menu.createListItem(e),e.setup&&e.setup()},bindControlHandler:function(t){var n=this;this.$container.on("click",t.selectors.join(),function(i){var r=e(this);n.$menu.targetData=n.$menu.targetData||{},n.$menu.targetData[t.name]=r,t.elementClick&&t.elementClick(),n.$menu.items.push(t.name)}),this.$menu.on("click",'[data-action="menu-'+t.name+'"]',t.onMenuClick)}}}(jQuery),jQuery.fn.IMHWPB_Draggable=function(e,t){var n=this,i=[],r=[];n.ie_version,n.isSafari,n.$master_container=this,n.$window=t(window),n.$body=n.$master_container.find("body"),n.$resize_overlay=t('<div id="boldgrid-draggable-resizing-overlay"></div>'),n.$master_container.find("html").append(n.$resize_overlay),n.original_selector_strings={},n.$mce_32=t("#mceu_34"),n.$mce_38=t("#mceu_40"),n.$post_status_info=t("#post-status-info");var o=e.menu_items||[];this.popover_placement_testing=e.popover_placement_testing||!1,this.hover_timout=e.hover_timout||175,this.type_popover_removal=e.type_popover_removal||!0,this.$interaction_container,this.$boldgrid_menu_action_clicked,this.last_auto_scroll_event=null,this.editting_as_row=!1,this.hover_elements={content:{add_element:null},column:{add_element:null},row:{add_element:null}},this.color_alias={white:["rgb(255, 255, 255)","white"],transparent:["rgba(0, 0, 0, 0)","transparent"]},this.scroll_speeds=e.scroll_speeds||{content:15,column:15,row:25},this.master_container_id="",this.resize_finish_event=t.Event("resize_done_dwpb"),this.resize_start_event=t.Event("resize_start_dwpb"),this.boldgrid_modify_event=t.Event("boldgrid_modify_content"),this.add_row_event=t.Event("add_row_event_dwpb"),this.delete_event=t.Event("delete_dwpb"),this.clear_event=t.Event("clear_dwpb"),this.add_column_event=t.Event("add_column_dwpb"),this.drag_start_event=t.Event("drag_start_dwpb"),this.boldgrid_edit_row=t.Event("boldgrid_edit_row"),this.drag_end_event=t.Event("drag_end_dwpb"),this.popovers_disabled=!1,this.right_resize_buffer=10,this.drag_end_event=t.Event("drag_end_dwpb"),this.nest_row=!1,this.popovers_disabled=!1,this.right_resize_buffer=10,this.drag_drop_triggered=!1,this.debug=e.debug,this.draggable_selectors_string,this.row_selectors_string,this.content_selectors_string,this.column_selectors_string,this.dragging_selector_class_name="dragging-imhwpb",this.dragging_selector="."+this.dragging_selector_class_name,this.$current_drag=null,this.resize=!1,this.valid_drag,this.border_hover_buffer=15,this.resize_buffer=.0213,this.max_row_size=12,this.$most_recent_row_enter_add=null,this.window_width,this.window_height,this.active_resize_class,this.restore_row=null,this.$temp_insertion=null,this.$cloned_drag_image=null,this.row_selector=e.row_selector||[".row:not("+n.master_container_id+" .row .row)"],this.add_media_event_handler=e.add_media_event_handler||function(){},this.insert_layout_event_handler=e.insert_layout_event_handler||function(){},this.general_column_selectors=e.general_column_selectors||['[class*="col-xs"]','[class*="col-sm"]','[class*="col-md"]','[class*="col-lg"]'],this.nested_row_selector_string=".row .row:not(.row .row .row)",this.general_content_selectors=["h1","h2","h3","h4","h5","h6","h7","a:not(p a)","img:not(p img):not(a img)","p","button:not(p button):not(a button)","ul","ol","dl","form","table",".row .row",'[data-imhwpb-draggable="true"]',".wpview-wrap","blockquote","code","abbr"],this.content_selectors=e.content_selectors||["h1:not("+n.master_container_id+" .row .row h1)","h2:not("+n.master_container_id+" .row .row h2)","h3:not("+n.master_container_id+" .row .row h3)","h4:not("+n.master_container_id+" .row .row h4)","h5:not("+n.master_container_id+" .row .row h5)","h6:not("+n.master_container_id+" .row .row h6)","h7:not("+n.master_container_id+" .row .row h7)","a:not("+n.master_container_id+".row .row a):not(p a)","img:not("+n.master_container_id+" .row .row img):not(p img):not(a img)","p:not("+n.master_container_id+" .row .row p)","button:not("+n.master_container_id+" .row .row button):not(p button):not(a button)","ul:not("+n.master_container_id+" .row .row ul)","ol:not("+n.master_container_id+" .row .row ol)","dl:not("+n.master_container_id+" .row .row dl)","form:not("+n.master_container_id+" .row .row form)","table:not("+n.master_container_id+" .row .row table)",".row .row:not(:not("+n.master_container_id+" .row .row))",'[data-imhwpb-draggable="true"]:not('+n.master_container_id+' .row .row [data-imhwpb-draggable="true"])',".wpview-wrap:not("+n.master_container_id+" .row .row .wpview-wrap)","blockquote:not(.row .row blockquote)","code:not(.row .row code)","abbr:not(.row .row abbr)"];var a=[".row .row h1",".row .row h2",".row .row h3",".row .row h4",".row .row h5",".row .row h6",".row .row h7",".row .row a",".row .row img:not(p img):not(a img)",".row .row p",".row .row button:not(p button):not(a button)",".row .row ul",".row .row ol",".row .row dl",".row .row form",".row .row table",".row .row .row",'.row .row [data-imhwpb-draggable="true"]',".row .row .wpview-wrap",".row .row code",".row .row blockquote",".row .row abbr"],s=["> h1","> h2","> h3","> h4","> h5","> h6","> h7","> a","> img","> p","> button","> ul","> ol","> dl","> form","> table","> .row","> dl","> form","> table",".row:not(.row .row)",'> [data-imhwpb-draggable="true"]',"> .wpview-wrap","> code","> blockquote","> abbr"];this.column_sizes={0:0,1:.083,2:.167,3:.25,4:.333,5:.416,6:.5,7:.583,8:.667,9:.75,10:.833,11:.917,12:1,13:0},this.dragImageSetting=e.dragImage||"browserImage",this.dragTypeSetting=e.dragType||"dragEnter",this.popover_fade=e.popover_fade||!1,this.layout_translation={"[12]":{12:"6","new":"6"},"[6,6]":{6:"4","new":"4"},"[4,4,4]":{4:"3","new":"3"},"[3,3,3,3]":{current:"3",current_transform:"2","new":"2",additional_transform:[{count:"1",from:"3",to:"2"}]},"[6,3,3]":{current:"3",current_transform:"2","new":"2",additional_transform:[{count:"1",from:"3",to:"2"}]}};var l=["duplicate","add-row","add-column","nest-row","clear","delete","clone-as-row"],c={column:{"":"Edit Column",duplicate:"Clone","delete":"Delete",clear:"Clear Contents","add-media":"Insert Media"},row:{"":"Edit Row",duplicate:"Clone","delete":"Delete",clear:"Clear Contents","insert-layout":"Insert GridBlock","add-column":"Add Column","add-row":"Add Empty Row","nest-row":"","toggle-container":"Toggle Container"},content:{"":"Edit Content",duplicate:"Clone","delete":"Delete"},"nested-row":{"":"Edit Content",duplicate:"Clone","delete":"Delete","clone-as-row":"Clone as Row"}};this.type_popover_classes={content:"content-popover-imhwpb left-popover-imhwpb","nested-row":"content-popover-imhwpb nested-row-popover-imhwpb left-popover-imhwpb",row:"row-popover-imhwpb right-popover-imhwpb",column:"top-popover-imhwpb column-popover-imhwpb"},this.toolkit_markup=function(e){var i='<div spellcheck="false" data-mce-bogus="all" contenteditable="false"unselectable="on" class="draggable-tools-imhwpb"><span class="popover-imhwpb '+n.type_popover_classes[e]+'"><div title="Move" contenteditable="false" draggable="true" class="no-select-imhwpb drag-handle-imhwpb draggable-button"> <span  class="genericon genericon-move" aria-hidden="true"> </span></div>';return i+="<div class='popover-menu-imhwpb hidden'><ul>",t.each(c[e],function(e,t){var n="";"nest-row"==e&&(n='draggable="true"'),i+="<li class='no-select-imhwpb action-list' "+n+" data-action='"+e+"'>"+t+"</li>"}),i+="</ul></div>",i+='<div title="Modify" class="context-menu-imhwpb draggable-button"> <span  class="genericon genericon-menu" aria-hidden="true"></span></div>',"nested-row"==e&&(i+='<div title="Edit As Row" class="edit-as-row draggable-button"><span class="genericon genericon-expand"  aria-hidden="true"></span></div>'),i+"</span></div>"},this.init=function(){return n.$interaction_container=n.determine_interaction_container(),n.$master_container.fourpan({element_padding:0,transition_speed:0,activate:g,deactivate:_}),n.ie_version=n.get_ie_version(),n.isSafari=n.checkIsSafari(),n.create_selector_strings(),d(),n.bind_events(),n.setup_additional_plugins(),n.validate_markup(),n.track_window_size(),n.merge_additional_menu_options(),BOLDGRID.EDITOR.Controls.init(n.$master_container),n};var d=function(){n.original_selector_strings={general_content_selector_string:n.general_content_selector_string,unformatted_content_selectors_string:n.unformatted_content_selectors_string,content_selectors_string:n.content_selectors_string,immediate_row_siblings_string:n.immediate_row_siblings_string,row_selectors_string:n.row_selectors_string,column_selectors_string:n.column_selectors_string,unformatted_column_selectors_string:n.unformatted_column_selectors_string,general_column_selectors_string:n.general_column_selectors_string,immediate_column_selectors_string:n.immediate_column_selectors_string,draggable_selectors_string:n.draggable_selectors_string}};this.create_selector_strings=function(){n.general_content_selector_string=n.general_content_selectors.join(),n.unformatted_content_selectors_string=n.content_selectors.join(),n.content_selectors_string=n.format_selectors(n.content_selectors).join(),n.immediate_row_siblings_string=s.join(),n.row_selectors_string=n.row_selector.join(),n.column_selectors_string=n.format_column_selectors(n.general_column_selectors,!0).join(),n.unformatted_column_selectors_string=n.column_selectors_string.replace(/:visible/,""),n.general_column_selectors_string=n.general_column_selectors.join(),n.immediate_column_selectors_string=n.format_immediate_column_selectors(n.general_column_selectors).join(),n.draggable_selectors_string=n.format_draggable_selectors_string()},this.set_background_colors=function(){var e=n.$body.css("background-color");(n.color_is(e,"transparent")||n.color_is(e,"white"))&&(n.$body.css("background-color","white"),n.color_is(n.$body.css("color"),"white")&&n.$body.css("color","black"))},this.validate_markup=function(){n.wrap_hr_tags(),n.wrap_content_elements(),n.add_redundant_classes()},this.failSafeCleanup=function(){n.$master_container.find(".dragging-started-imhwpb").remove(),n.$master_container.find(".cloned-div-imhwpb").removeClass("cloned-div-imhwpb")},this.wrap_content_elements=function(){n.$master_container.find("img, a").each(function(){var e=t(this);e.parent().closest_context(n.original_selector_strings.content_selectors_string,n.$master_container).length||e.wrap("<p class='mod-reset'></p>")})},this.wrap_hr_tags=function(){n.$master_container.find("hr").each(function(){var e=t(this);if(!e.closest_context(n.original_selector_strings.content_selectors_string,n.$master_container).length){var i=e.closest_context(n.original_selector_strings.row_selectors_string+", "+n.original_selector_strings.general_column_selectors_string,n.$master_container);i.is(n.original_selector_strings.row_selectors_string)?e.wrap("<div class='col-md-12'><div class='row'><div class='col-md-12'></div></div></div>"):e.wrap("<div class='row'><div class='col-md-12'></div></div>")}})},this.merge_additional_menu_options=function(){t.each(o,function(e,n){var i=c[n.element_type],r={};r[n.title]=n.title,t.extend(i,r)})},this.determine_interaction_container=function(){var e=null,t=n.$master_container.find("body");return e=t.length?n.$master_container:n.$master_container.closest("html")},this.bind_events=function(){n.bind_drag_listeners(),n.bind_container_events(),n.bind_menu_items(),n.bind_additional_menu_items(),n.bind_edit_row(),setTimeout(function(){n.set_background_colors()},1e3)};var _=function(){n.editting_as_row&&(n.content_selectors=n.original_selectors.content,n.row_selector=n.original_selectors.row,n.create_selector_strings(),n.$master_container.off(".draggable"),n.bind_events(),t.fourpan.$recent_highlight.removeClass("current-edit-as-row"),n.editting_as_row=!1,n.$body.removeClass("editing-as-row"),n.window_mouse_leave())},g=function(){n.original_selectors={},n.original_selectors.content=n.content_selectors,n.original_selectors.row=n.row_selector,n.content_selectors=a,n.row_selector=[n.nested_row_selector_string],n.create_selector_strings(),n.$master_container.off(".draggable"),n.bind_events(),n.$master_container.find(".current-edit-as-row").removeClass("current-edit-as-row"),t.fourpan.$recent_highlight.addClass("current-edit-as-row"),n.editting_as_row=t.fourpan.$recent_highlight,n.$body.addClass("editing-as-row"),n.window_mouse_leave()};this.bind_edit_row=function(){n.$master_container.on("click.draggable",".edit-as-row",function(){var e=t(this),i=e.closest(".draggable-tools-imhwpb").next();n.$master_container.trigger(n.boldgrid_edit_row,i),n.editting_as_row?t.fourpan.dismiss():t.fourpan.highlight(i)})},this.unbind_all_events=function(){n.$master_container.off(".draggable"),n.$master_container.off(".draggable_mce"),n.$body.attr("style","")},this.hide_menus=function(e){var i=!1;if(e&&e.target){var r=t(e.target);r.closest(".popover-menu-imhwpb").length?i=!0:r.closest(".context-menu-imhwpb").siblings(".popover-menu-imhwpb:visible").length&&(i=!0)}if(0==i){var o=n.$master_container.find(".popover-menu-imhwpb");r&&o.not(r.closest(".popover-menu-imhwpb")).addClass("hidden")}},this.setup_additional_plugins=function(){t.fn.is_typing_boldgrid&&n.$master_container.is_typing_boldgrid()},this.bind_container_events=function(){n.$master_container.on("click.draggable",".drag-handle-imhwpb, .draggable-tools-imhwpb",n.prevent_default_draghandle).on("mousedown.draggable",".drag-handle-imhwpb",n.drag_handle_mousedown).on("mouseup.draggable",".drag-handle-imhwpb",n.drag_handle_mouseup).on("click.draggable",n.hide_menus).on("click.draggable",n.failSafeCleanup).on("click.draggable",".context-menu-imhwpb",n.setup_context_menu).on("boldgrid_modify_content.draggable",n.refresh_fourpan),n.type_popover_removal&&n.$master_container.on("start_typing_boldgrid.draggable",n.typing_events.start).on("end_typing_boldgrid.draggable",n.typing_events.end),n.$master_container.on("mouseenter.draggable",n.draggable_selectors_string+", .draggable-tools-imhwpb",n.insert_drag_handles).on("mouseleave.draggable",n.draggable_selectors_string+", .draggable-tools-imhwpb",n.remove_drag_handles),n.$interaction_container.on("mouseleave.draggable",n.window_mouse_leave).on("mouseup.draggable",n.master_container_mouse_up).on("mousemove.draggable",n.mousemove_container),(n.ie_version>11||!n.ie_version)&&n.$interaction_container.on(n.resize_event_map,n.column_selectors_string)},this.bind_menu_items=function(){n.$master_container.on("click.draggable",'li[data-action="delete"]',n.menu_actions.delete_element).on("click.draggable",'li[data-action="add-column"]',n.menu_actions.add_column).on("click.draggable",'li[data-action="duplicate"]',n.menu_actions.duplicate).on("click.draggable",'li[data-action="clear"]',n.menu_actions.clear).on("click.draggable",'li[data-action="insert-layout"]',n.menu_actions.insert_layout).on("click.draggable",'li[data-action="nest-row"]',n.menu_actions.nest_row).on("click.draggable",'li[data-action="add-row"]',n.menu_actions.add_row).on("click.draggable",'li[data-action="clone-as-row"]',n.menu_actions.unnest_row).on("click.draggable","li[data-action]",n.menu_actions.trigger_action_click).on("click.draggable",'li[data-action="add-media"]',n.menu_actions.add_media)},this.bind_additional_menu_items=function(){t.each(o,function(e,t){n.$master_container.on("click.draggable",'li[data-action="'+t.title+'"]',t.callback)})},this.bind_drag_listeners=function(){n.$window.on("dragover.draggable",n.drag_handlers.over),n.$interaction_container.on("dragleave.draggable",function(){!n.$body.find(n.$current_drag).length&&n.$current_drag&&(n.$current_drag.hide(),n.$body.append(n.$current_drag))}),n.$interaction_container.on("dragstart.draggable",'.drag-handle-imhwpb, [data-action="nest-row"]',n.drag_handlers.start).on("dragstart.draggable","img, a",n.drag_handlers.hide_tooltips).on("dragover.draggable",n.drag_handlers.iframe_over).on("drop.draggable",n.drag_handlers.drop).on("dragend.draggable",n.drag_handlers.end).on("dragleave.draggable",n.drag_handlers.leave_dragging).on("dragenter.draggable",n.drag_handlers.record_drag_enter)},this.refresh_fourpan=function(){n.editting_as_row&&t.fourpan.refresh()},t.fn.reverse=[].reverse,t.fn.remove_popover_imhwpb=function(){1==n.popover_fade?this.attr("fading-imhwpb","true").fadeOut("fast",function(){t(this).remove()}):n.popover_placement_testing||t(this).remove()},t.fn.is_after=function(e){return 0!==this.prevAll().filter(e).length},t.fn.is_before=function(e){return 0!==this.nextAll().filter(e).length},t.fn.closest_context=function(e,t){var n;return n=this.is(e)?this:this.parentsUntil(t).filter(e).eq(0)},this.add_redundant_classes=function(){n.$master_container.find(n.original_selector_strings.general_column_selectors_string).each(function(){$current_element=t(this),$current_element.addClass(n.find_column_sizes($current_element))})},this.track_window_size=function(){n.active_resize_class=n.determine_class_sizes(),n.$window.on("load resize",function(){setTimeout(function(){n.active_resize_class=n.determine_class_sizes()},300)})},this.prevent_default=function(e){e.preventDefault&&e.preventDefault()},this.format_draggable_selectors_string=function(){var e=[];return e.push(n.content_selectors_string),e.push(n.column_selectors_string),e.push(n.row_selectors_string),e.join()},this.format_immediate_column_selectors=function(e){var i=n.format_selectors(e).slice();return t.each(i,function(e,t){t="> "+t,i[e]=t}),i},this.find_column_sizes=function(e){var t=e.attr("class"),n=[],i=t.match(/col-xs-([\d]+)/i),r=t.match(/col-sm-([\d]+)/i),o=t.match(/col-md-([\d]+)/i),a=12;return i?a=i[1]:n.push("col-xs-"+a),r?a=r[1]:n.push("col-sm-"+a),o||n.push("col-md-"+a),n.join(" ")},this.format_column_selectors=function(e,i){var r=e;return i&&(r=n.format_selectors(e).slice()),t.each(r,function(e,t){t=n.row_selectors_string+" > "+t,r[e]=t}),r},this.format_selectors=function(e){var n=e.slice();return t.each(n,function(e,t){t+=":visible",n[e]=t}),n},this.before_or_after_drop=function(e,t){var n=e.get(0).getBoundingClientRect(),i=-(n.height/n.width),r=Math.floor(n.bottom)-i*n.left,o=i*t.x+r;return o<=t.y?drop_point="after":drop_point="before",drop_point},this.remove_receptor_containers=function(){n.$master_container.find(".receptor-containers-imhwpb").removeClass("receptor-containers-imhwpb")},this.finish_dragging=function(){n.$cloned_drag_image&&n.$cloned_drag_image.remove&&n.$cloned_drag_image.remove(),n.$temp_insertion&&n.$temp_insertion.removeClass("cloned-div-imhwpb"),n.$master_container.find(n.dragging_selector).removeClass(n.dragging_selector_class_name),n.valid_drag=!1,n.remove_receptor_containers(),n.$master_container.trigger(n.boldgrid_modify_event)},this.array_equal=function(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!=t.length)return!1;for(var n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},this.slide_in_place=function(e,t){var i=t.offset(),r=e.offset();e.animate({top:parseInt(e.css("top"))+(i.top-r.top),left:parseInt(e.css("left"))+(i.left-r.left)},"600",n.drag_cleanup)},this.drag_cleanup=function(){n.ie_version||n.validate_markup(),n.$current_drag.remove(),n.finish_dragging(),n.$master_container.trigger(n.drag_end_event,n.$temp_insertion),n.refresh_handle_location(),n.$current_drag=null,n.$master_container.removeClass("drag-progress")},this.refresh_handle_location=function(){n.remove_all_popovers(),n.update_handles(n.last_hover)},this.determine_current_drag_properties=function(){var e="",t="";n.$current_drag.IMHWPB.is_row?e=n.row_selectors_string:n.$current_drag.IMHWPB.is_column?(t=n.row_selectors_string,e=n.general_column_selectors_string):n.$current_drag.IMHWPB.is_content&&(t=n.column_selectors_string,e=n.content_selectors_string),n.$current_drag.properties={sibling:e,parent:t}},this.between=function(e,t,n){return e>=t&&e<=n},this.remove_all_popovers=function(){n.last_hover=null,n.hover_elements.type={content:null,column:null,row:null},n.delete_popovers()},this.delete_popovers=function(){n.$master_container.find(".draggable-tools-imhwpb").each(function(){var e=t(this),n=e.next();n.length&&(n[0].popover=null),e.remove_popover_imhwpb()})},this.setup_context_menu=function(e){e.preventDefault(),e.stopPropagation(),n.hide_menus(e),t(this).closest(".draggable-tools-imhwpb").find(".popover-menu-imhwpb").toggleClass("hidden")},this.get_element_type=function(e){var t="";return e.is(n.content_selectors_string)?t="content":e.is(n.row_selectors_string)?t="row":e.is(n.column_selectors_string)&&(t="column"),t},this.remove_drag_handles=function(e){var i,r,o=t(this);if(e.relatedTarget){n.remove_receptor_containers();var a=t(e.relatedTarget||e.toElement);if(0!=a.length){var s=a.closest(".draggable-tools-imhwpb");if(o.hasClass("draggable-tools-imhwpb")){if(o.next().find(a).length||o.next()[0]==a[0])return!1;r=o,i=o.next()}else if(s[0]!=this.popover||0==s.length){var l=n.get_element_type(o),c=o.parent().closest_context(n.content_selectors_string,n.$master_container).length;if("content"==l&&c)return!1;if(o.find(a).length)return!1;r=o.prev(".draggable-tools-imhwpb"),i=o}if(i&&i.length){var l=n.get_element_type(i);l&&n.hover_elements[l]&&"undefined"!=typeof n.hover_elements[l].add_element&&null!=n.hover_elements[l].add_element&&(n.hover_elements[l].add_element=null,"row"==l?(n.hover_elements.column={add_element:null},n.hover_elements.content={add_element:null}):"column"==l&&(n.hover_elements.content={add_element:null}))}i&&i.length&&r&&r.length&&(n.last_hover=(new Date).getTime(),n.hover_elements[l]={remove_element:{element:i,tools:r}},setTimeout(n.update_handles,n.hover_timout,n.last_hover))}}},this.remove_drag_handle=function(e,t){t&&t.remove_popover_imhwpb(),e&&e.length&&(e[0].popover=null,0==n.$current_drag&&e.removeClass(n.dragging_selector_class_name))},this.get_tooltip_type=function(e){if(e.is(n.nested_row_selector_string)&&0==e.find("> .col-md-12 > hr:only-child").length&&!n.editting_as_row)var t="nested-row";else var t=n.get_element_type(e);return t},this.insert_popover=function(e){if(n.$master_container.find(e)){var t=n.get_tooltip_type(e);if(t){e.before(n.toolkit_markup(t));var i=e.prev(".draggable-tools-imhwpb");e.offset(),e.offsetParent().offset();if(e[0].popover=i[0],"content"==t||"nested-row"==t){n.$content_tooltip&&n.$content_tooltip.remove(),n.$content_tooltip=i;var r=e[0].getBoundingClientRect(),o=r.left-17;o<25&&(o=25),i.css({top:r.top-25,left:o})}else if("column"==t){n.$column_tooltip&&n.$column_tooltip.remove(),n.$column_tooltip=i;var r=e[0].getBoundingClientRect();i.css({top:r.top,left:r.left})}else"row"==t&&(n.$row_tooltip&&n.$row_tooltip.remove(),n.$row_tooltip=i,i.css({position:"relative"}))}}},this.get_top_level_elements=function(){return n.$body.find("> *").not(".draggable-tools-imhwpb")},this.insert_drag_handles=function(e){var i=t(this);if(!n.resize&&!n.popovers_disabled){var r=n.get_top_level_elements();if(1===r.length&&"P"==r[0].tagName)return;var o=i.closest(".draggable-tools-imhwpb");o.length&&(i=o.next());var a=n.get_element_type(i);"content"==a&&1==i.parent().closest_context(n.content_selectors_string,n.$master_container).length&&(i=i.parents(n.content_selectors_string).last()),n.last_hover=(new Date).getTime(),n.hover_elements[a]={add_element:i},setTimeout(n.update_handles,n.hover_timout,n.last_hover)}},this.update_handles=function(e){if(e==n.last_hover){if(n.is_typing&&1==n.is_typing)return!1;t.each(n.hover_elements,function(e,i){if(this.add_element&&0==this.add_element.prev().hasClass("draggable-tools-imhwpb")?n.insert_popover(this.add_element):this.remove_element&&n.remove_drag_handle(this.remove_element.element,this.remove_element.tools),!this.add_element){var r=n.$master_container.find("."+e+"-popover-imhwpb").closest(".draggable-tools-imhwpb");r.each(function(){var e=t(this);n.remove_drag_handle(e.next(),e)})}})}},this.find_row_layout=function(e){var i=[],r=[],o=0;return e.find(n.immediate_column_selectors_string).each(function(){var e={},a=t(this),s=n.find_column_size(a);s+o<=12?(e.size=s,e.object=a[0],r.push(e),o+=s):(i.push(r),r=[],e.size=o=s,e.object=a[0],r.push(e))}),r.length&&i.push(r),i},this.find_column_stack=function(e,i){var r=[],o=null,a=n.find_row_layout(e);return t.each(a,function(e,n){if(t.each(n,function(t,a){if(i==a.object)return r=n,o=e,!1}),r.length)return!1}),{stack:r,stack_index:o}},this.check_adjacent_column=function(e,n){var i=!1;return n.length&&t.each(e,function(e,t){if(n[0]==t.object)return i=!0,!1}),i},this.mousemove_container=function(e){if(n.pageX=e.originalEvent.clientX,n.pageY=e.originalEvent.clientY,n.resize){var t,i,r,o,a=n.resize.element.closest_context(n.row_selectors_string,n.$master_container),s=a[0].getBoundingClientRect().width,l=n.find_column_size(n.resize.element),c=n.resize.element[0].getBoundingClientRect(),d=n.find_row_size(a),_=n.column_sizes[l]*s,g=n.column_sizes[l+1]*s,m=n.column_sizes[l-1]*s;n.resize.left?(t=g-_+c.left,i=m-_+c.left,r=n.pageX>t,o=n.pageX<i):(t=m-_+c.right,i=g-_+c.right,r=n.pageX<t,o=n.pageX>i||a[0].getBoundingClientRect().right+n.right_resize_buffer<n.pageX);var u=s*n.resize_buffer,h=r||n.between(t,n.pageX-u,n.pageX+u),f=o||n.between(i,n.pageX-u,n.pageX+u),p=h&&l>1,v=f&&l<n.max_row_size;if(p||v){var b=n.find_column_stack(a,n.resize.element[0]);if(n.resize.left&&n.resize.element[0]==b.stack[0].object)return n.$master_container.addClass("cursor-not-allowed-imhwpb"),!1;var w=b.stack[b.stack.length-1].object==n.resize.element[0];if(n.resize.right&&12==d&&v&&"col-md"==n.active_resize_class&&w)return!1;var $=n.check_adjacent_column(b.stack,n.resize.sibling)}if(p){n.change_column_size(n.resize.element,!1),n.resize.sibling.length&&n.find_column_size(n.resize.sibling)<n.max_row_size&&$&&n.change_column_size(n.resize.sibling);var D=n.find_column_stack(a,n.resize.element[0]);b.stack_index!=D.stack_index&&n.end_resize()}else if(v){if(n.resize.sibling.length&&1==n.find_column_size(n.resize.sibling))return;n.change_column_size(n.resize.element),$&&n.change_column_size(n.resize.sibling,!1);var D=n.find_column_stack(a,n.resize.element[0]);b.stack_index!=D.stack_index&&n.end_resize()}}},this.prevent_default_draghandle=function(e){e.preventDefault()},this.frame_cleanup=function(e){var i=t("<div>"+e+"</div>");return n.remove_resizing_classes(i),n.remove_border_classes(i),i.find(".draggable-tools-imhwpb").remove(),i.html()},this.remove_resizing_classes=function(e){e.find(".resizing-imhwpb").removeClass("resizing-imhwpb")},this.remove_border_classes=function(e){e.find(".resize-border-left-imhwpb, .resizing-imhwpb, .resize-border-right-imhwpb, .content-border-imhwpb").removeClass("resize-border-right-imhwpb resizing-imhwpb resize-border-left-imhwpb content-border-imhwpb")},this.end_resize=function(){n.resize=!1,n.remove_border_classes(n.$master_container);var e=n.$master_container.find("body");e.length||(e=n.$master_container),e.removeClass("no-select-imhwpb"),n.remove_resizing_classes(n.$master_container),n.$master_container.removeClass("resizing-imhwpb cursor-not-allowed-imhwpb"),n.$master_container.trigger(n.resize_finish_event)},this.window_mouse_leave=function(){n.resize&&n.end_resize(),n.remove_resizing_classes(n.$master_container),n.remove_all_popovers(),n.hover_elements={content:null,column:null,row:null}},this.drag_handle_mousedown=function(e){n.valid_drag=!0,n.$current_clicked_element=t(this).closest(".draggable-tools-imhwpb").next(),n.$current_clicked_element.is("a")&&n.$current_clicked_element.find("img, button").length?n.$current_clicked_element.find("img, button").first().addClass("dragging-imhwpb"):n.$current_clicked_element.addClass("dragging-imhwpb"),n.$current_clicked_element.is(n.content_selectors_string)?n.$master_container.find(n.column_selectors_string).addClass("receptor-containers-imhwpb"):n.$current_clicked_element.is(n.row_selectors_string)?n.$master_container.find(n.row_selectors_string).addClass("receptor-containers-imhwpb"):n.$current_clicked_element.is(n.column_selectors_string)&&(n.$master_container.find(n.column_selectors_string).addClass("receptor-containers-imhwpb"),n.$master_container.find(n.row_selectors_string).addClass("receptor-containers-imhwpb"))},this.drag_handle_mouseup=function(){n.remove_receptor_containers(),n.valid_drag=!1},this.master_container_mouse_up=function(e,i){if(n.resize&&n.end_resize(),n.$current_clicked_element&&n.$current_clicked_element.removeClass("dragging-imhwpb"),"undefined"==typeof i)var r=t(e.target);else var r=t(i);0==r.closest(".draggable-tools-imhwpb").length&&r.trigger("mouseenter")},this.decrease_row_size=function(e){var i=!1;return e.find(n.immediate_column_selectors_string).reverse().each(function(){var e=t(this);if(n.find_column_size(e)>=2)return n.change_column_size(e,!1),i=!0,!1}),i},this.get_border_mouse_location=function(e,t){var i=e[0].getBoundingClientRect(),r=Math.floor(i.left),o=Math.floor(i.right),a=n.between(t,o-n.border_hover_buffer,o),s=n.between(t,r,r+n.border_hover_buffer);return s&&0==e.prevAll(n.column_selectors_string).length&&(s=!1),{left:s,right:a}},this.transform_layout=function(e,i){t.each(i,function(i,r){e.find(n.immediate_column_selectors_string).each(function(){var e=t(this);i==n.find_column_size(e)&&n.change_column_size(e,null,r)})})},this.find_layout_transform=function(e,t){var i=JSON.stringify(e),r=n.layout_translation[i];return"undefined"!=typeof t&&"undefined"!=typeof r&&"undefined"!=typeof r.current&&r.current!=t?r=null:"undefined"==typeof t&&"undefined"!=typeof r&&r.current&&(r=null),r},this.get_layout_format=function(e){var i=[];return e.find(n.immediate_column_selectors_string).each(function(){i.push(n.find_column_size(t(this)))}),i},this.change_column_size=function(e,i,r){if(e.length){var o=new RegExp(n.active_resize_class+"-[\\d]+","i");t.each(e.attr("class").split(" "),function(t,n){if(n.match(o)){var a=parseInt(n.replace(/\D/g,""));r?a=r:i===!1?a--:a++;var s=n.replace(/\d+/g,a),l=e.attr("class").replace(n,s);return e.attr("class",l),!1}}),n.$master_container.trigger(n.boldgrid_modify_event)}},this.find_column_size=function(e){var t=0,i=new RegExp(n.active_resize_class+"-([\\d]+)","i"),r=e.attr("class").match(i);return r&&(t=r[1]),parseInt(t)},this.find_row_size=function(e){var i=0;return e.find(n.immediate_column_selectors_string).not(".dragging-imhwpb").each(function(){i+=n.find_column_size(t(this))}),i},this.set_drag_to_cursor=function(e){var t={};t=n.$current_drag.IMHWPB.is_row?{top:e.originalEvent.pageY}:n.$current_drag.IMHWPB.is_column&&0==n.$current_drag.IMHWPB.unlock_column?{left:e.originalEvent.pageX}:{top:e.originalEvent.pageY,left:e.originalEvent.pageX},n.$current_drag.offset(t),n.$current_drag.show()},this.determine_class_sizes=function(){var e,t=n.$master_container.width();return e=t>1061?"col-md":t>837?"col-sm":"col-xs"},this.color_is=function(e,t){return n.color_alias[t].indexOf(e)!==-1};var m=function(e,t){if(t>=200)var n=1.25*t;else var n=250;e.css({"max-height":n+"px",overflow:"hidden"})};this.add_max_heights=function(){"column"==n.$current_drag.IMHWPB.type?n.$master_container.find(n.row_selectors_string).each(function(){
var e=t(this),i=n.find_row_size(e);if(i<=12){var r=e.outerHeight();m(e,r)}}):"content"==n.$current_drag.IMHWPB.type&&m(n.$temp_insertion,n.$current_drag.IMHWPB.height)};var u=function(e){e.css({"max-height":"",overflow:""})};return this.remove_max_heights=function(){"column"==n.$current_drag.IMHWPB.type?u(n.$master_container.find(n.row_selectors_string)):"content"==n.$current_drag.IMHWPB.type&&u(n.$temp_insertion)},this.get_other_top_level_elements=function(){return n.$body.find(n.immediate_row_siblings_string).not(n.$current_drag)},this.find_page_min_max=function(){var e={};if(n.$current_drag.IMHWPB.is_row){var t=n.get_other_top_level_elements(),i=t.eq(0),r=t.last();e={offset_top:i[0].getBoundingClientRect().top,offset_bottom:r[0].getBoundingClientRect().top+r.outerHeight(!0)}}return e},this.find_row_min_max=function(){var e={};if(n.$current_drag.IMHWPB.is_column){var t=n.$current_drag.closest(".row"),i=t.get(0),r=i.getBoundingClientRect();e={offset_left:r.left,offset_right:r.left+t.outerWidth(!0),offset_top:Math.max(0,r.top-150),offset_bottom:r.top+t.outerHeight(!0)}}return e},this.find_top_level_positions=function(){var e=[];if(n.$current_drag.IMHWPB.is_row){var i=n.get_other_top_level_elements();i.each(function(){var n=t(this),i=n.outerHeight(!0);e.push({max:this.getBoundingClientRect().top+i,element:n})})}return e},this.find_column_sibling_positions=function(){var e=[];return n.$current_drag.IMHWPB.is_column&&n.$current_drag.siblings(n.general_column_selectors_string).each(function(){var n=t(this),i=n.outerWidth(!0),r=this.getBoundingClientRect();e.push({max:r.left+i,element:n})}),e},this.recalc_col_pos=function(){n.$current_drag.IMHWPB.col_pos=n.find_column_sibling_positions(),n.$current_drag.IMHWPB.row_min_max=n.find_row_min_max()},this.recalc_row_pos=function(){n.$current_drag.IMHWPB.row_pos=n.find_top_level_positions(),n.$current_drag.IMHWPB.row_min_max=n.find_page_min_max()},this.reposition_row=function(e){if(n.$current_drag.IMHWPB.is_row){if(e<n.$current_drag.IMHWPB.row_min_max.offset_top){var i=n.get_other_top_level_elements().first();return void(i.get(0)!=n.$temp_insertion[0]&&(i.before(n.$temp_insertion),n.recalc_row_pos(),n.$master_container.trigger(n.boldgrid_modify_event)))}if(e>n.$current_drag.IMHWPB.row_min_max.offset_bottom){var o=n.get_other_top_level_elements().last();return void(o.get(0)!=n.$temp_insertion[0]&&(o.after(n.$temp_insertion),n.recalc_row_pos(),n.$master_container.trigger(n.boldgrid_modify_event)))}t.each(n.$current_drag.IMHWPB.row_pos,function(){if(e<this.max){var t=n.get_other_top_level_elements();return r[0]!=this.element[0]&&(r=this.element,t.index(this.element)<t.index(n.$temp_insertion)?this.element.before(n.$temp_insertion):t.index(this.element)>t.index(n.$temp_insertion)&&t.index(this.element)-1!=t.index(n.$temp_insertion)?this.element.before(n.$temp_insertion):this.element.after(n.$temp_insertion),n.$master_container.trigger(n.boldgrid_modify_event),n.recalc_row_pos(),!1)}})}},this.reposition_column=function(e,r){if(n.$current_drag.IMHWPB.is_column&&0==n.$current_drag.IMHWPB.unlock_column){if(n.$current_drag.IMHWPB.row_min_max.offset_top>r||n.$current_drag.IMHWPB.row_min_max.offset_bottom<r){n.$current_drag.IMHWPB.unlock_column=!0;var o=n.entered_target.closest(n.row_selectors_string);return void(o.length&&n.move_column_to(n.entered_target))}if(e<n.$current_drag.IMHWPB.row_min_max.offset_left){var a=n.$current_drag.closest(n.row_selectors_string).find(n.immediate_column_selectors_string).not(n.$current_drag).eq(0);return void(a.get(0)!=n.$temp_insertion[0]&&(a.before(n.$temp_insertion),n.recalc_col_pos(),n.$master_container.trigger(n.boldgrid_modify_event)))}if(e>n.$current_drag.IMHWPB.row_min_max.offset_right){var s=n.$current_drag.closest(n.row_selectors_string).find(n.immediate_column_selectors_string).not(n.$current_drag).last();return void(s.get(0)!=n.$temp_insertion[0]&&(s.after(n.$temp_insertion),n.recalc_col_pos(),n.$master_container.trigger(n.boldgrid_modify_event)))}t.each(n.$current_drag.IMHWPB.col_pos,function(){if(e<this.max)return i[0]!=this.element[0]&&(i=this.element,this.element.nextAll().not(n.$current_drag).filter(n.$temp_insertion).length?this.element.before(n.$temp_insertion):this.element.prevAll(n.general_column_selectors_string).not(n.$current_drag).get(0)!=n.$temp_insertion[0]?this.element.before(n.$temp_insertion):this.element.after(n.$temp_insertion),n.$master_container.trigger(n.boldgrid_modify_event),n.recalc_col_pos(),!1)})}},this.drag_handlers={hide_tooltips:function(){n.$current_drag||setTimeout(function(){n.$master_container.find(".draggable-tools-imhwpb").addClass("hidden")},100)},drop:function(e){n.$current_drag&&(n.prevent_default(e),n.drag_handlers.end(e),n.drag_drop_triggered=!0)},end:function(e){if(!n.drag_drop_triggered&&n.$current_drag)return n.restore_row=null,n.$most_recent_row_enter_add=null,n.remove_max_heights(),"actual"==n.dragImageSetting?n.slide_in_place(n.$current_drag,n.$temp_insertion):n.drag_cleanup(),!0},start:function(e){n.valid_drag=!0,n.drag_drop_triggered=!1;var i=t(this),r=i.closest(".draggable-tools-imhwpb");setTimeout(function(){n.$master_container.find(".draggable-tools-imhwpb").addClass("hidden")},100),n.$current_drag=r.next().addClass("dragging-imhwpb"),n.$master_container.addClass("drag-progress"),n.$current_drag.parent("a").length?n.original_html=n.$current_drag.parent("a")[0].outerHTML:n.original_html=n.$current_drag[0].outerHTML;var o=r.find(".popover-imhwpb");if(n.$current_drag.IMHWPB={right_popover:o.hasClass("right-popover-imhwpb"),column_popover:o.hasClass("column-popover-imhwpb"),is_column:n.$current_drag.is(n.column_selectors_string),is_row:n.$current_drag.is(n.row_selectors_string),is_content:n.$current_drag.is(n.content_selectors.join()),height:n.$current_drag.outerHeight(),width:n.$current_drag.outerWidth(),dragStarted:!0},n.$current_drag.IMHWPB.is_row&&i.hasClass("action-list")&&(n.$current_drag.IMHWPB.is_row=!1,n.$current_drag.IMHWPB.is_content=!0),n.$current_drag.IMHWPB.is_column){n.$current_drag.IMHWPB.column_size=n.find_column_size(n.$current_drag);var a=n.$current_drag.closest_context(n.row_selectors_string,n.$master_container);a.length&&(n.$current_drag.IMHWPB.original_row=a[0])}if(n.determine_current_drag_properties(),e.originalEvent.dataTransfer.setData("text"," "),e.originalEvent.dataTransfer.dropEffect="copy",n.$temp_insertion=t(n.original_html),n.$temp_insertion.removeClass("dragging-imhwpb"),n.$temp_insertion.addClass("cloned-div-imhwpb"),"actual"==n.dragImageSetting){if(n.$current_drag.css({height:n.$current_drag.IMHWPB.height,width:n.$current_drag.IMHWPB.width}).addClass("hidden dragging-started-imhwpb"),n.$current_drag.attr("data-mce-bogus","all"),n.color_is(n.$current_drag.css("background-color"),"transparent")&&n.$current_drag.parents().each(function(){var e=t(this),i=e.css("background-color");if(!n.color_is(i,"transparent"))return n.$current_drag.css("background-color",i),!1}),setTimeout(function(){n.color_is(n.$current_drag.css("background-color"),"transparent")&&n.$current_drag.css({"background-color":"white",color:"#333"})},100),"undefined"!=typeof e.originalEvent.dataTransfer.setDragImage&&!n.isSafari){var s=document.createElement("img");s.src="",e.originalEvent.dataTransfer.setDragImage(s,0,0)}}else"browserImage"==n.dragImageSetting&&(n.$cloned_drag_image=t(n.original_html),n.$cloned_drag_image.addClass("temporary-image-div"),document.body.appendChild(n.$cloned_drag_image[0]),e.originalEvent.dataTransfer.setDragImage(n.$cloned_drag_image[0],0,0),n.$current_drag.addClass("hidden"));n.$current_drag.before(n.$temp_insertion),n.$current_drag.IMHWPB.is_column?(n.$current_drag.IMHWPB.type="column",n.recalc_col_pos(),n.find_row_size(n.$current_drag.closest(".row"))<=12&&"col-md"==n.active_resize_class&&n.$current_drag.siblings(n.unformatted_column_selectors_string).not(n.$temp_insertion).length?n.$current_drag.IMHWPB.unlock_column=!1:n.$current_drag.IMHWPB.unlock_column=!0):n.$current_drag.IMHWPB.is_row?(n.$current_drag.IMHWPB.type="row",n.recalc_row_pos()):n.$current_drag.IMHWPB.type="content",n.add_max_heights();var l=100;n.ie_version&&(l=150),setTimeout(function(){n.$current_drag.removeClass("hidden"),n.$master_container.trigger(n.drag_start_event),n.$master_container.find(".resizing-imhwpb").removeClass("resizing-imhwpb")},l)},iframe_over:function(e){"actual"==n.dragImageSetting&&n.$current_drag&&(e.preventDefault(),n.set_drag_to_cursor(e))},over:function(e){if(n.$current_drag&&n.valid_drag&&(e.preventDefault(),!n.last_auto_scroll_event||n.last_auto_scroll_event+50<=(new Date).getTime())){if(n.last_auto_scroll_event=(new Date).getTime(),n.$current_drag.IMHWPB.dragStarted&&(n.reposition_row(e.originalEvent.pageY),n.reposition_column(e.originalEvent.pageX,e.originalEvent.pageY)),n.$body.hasClass("editing-as-row"))return;var t=n.scroll_speeds[n.$current_drag.IMHWPB.type],i=outerHeight-innerHeight,r=100,o=e.originalEvent.screenY-i-n.$mce_32[0].getBoundingClientRect().bottom,a=n.$window.scrollTop();a>=125&&o<=r&&scrollBy(0,-t);var s="fixed"==n.$post_status_info.css("position");if(s){var l=n.$mce_38[0].getBoundingClientRect().top-(e.originalEvent.screenY-i);l<=r&&scrollBy(0,t)}else{var l=innerHeight-(e.originalEvent.screenY-i);l<=r&&scrollBy(0,t)}}},leave_dragging:function(e){if(n.$current_drag&&!n.$current_drag.IMHWPB.is_row){n.ie_version||e.preventDefault();var i=t(e.target),r=n.entered_target;if(n.prevent_duplicate_location_events(e)||!n.$current_drag)return!1;if(n.$temp_insertion[0]==r[0])return n.$most_recent_row_enter_add=null,!0;if(0==n.$master_container.has(r).length&&0==n.$current_drag.IMHWPB.is_content)return!0;if(n.$current_drag.IMHWPB.is_content){var o=i.closest_context(n.row_selectors_string,n.$master_container),a=!!o.parent().closest(r).length;if(a){i=i.closest_context(n.row_selectors_string,n.$master_container);var s=n.before_or_after_drop(i,{x:e.originalEvent.clientX,y:e.originalEvent.clientY});"before"==s?i.before(n.$temp_insertion):i.after(n.$temp_insertion)}else{if(0==n.$master_container.has(r).length)return!0;var l=r.parents(n.content_selectors_string).last();if(1==l.length&&(r=l),r.is(n.unformatted_content_selectors_string)&&r[0]!=n.$current_drag[0]&&(r.find(i).length||r[0]==i[0]))return!0;var c=r.closest_context(n.$current_drag.properties.parent,n.$master_container),d=c.length,_=!1,g=[];if(d){if(0==n.editting_as_row){var g=c.find(n.content_selectors_string+", .row:not(.row .row .row)").not(".dragging-imhwpb");_=g.length>0}else{var g=c.find(n.general_content_selector_string).not(".dragging-imhwpb");_=g.length>0,1==g.length&&g.find("[data-action]")&&(_=!1)}0==_&&(r=c)}var m=r.is(n.unformatted_column_selectors_string);m&&g.length&&0==r.find(i).length&&(r=g.last(),_=!1);var u=r.is(n.unformatted_content_selectors_string+",hr:not("+n.master_container_id+".row .row hr)");if(!u&&1==_)return!0;var h=r.closest(".cloned-div-imhwpb"),f=h.length&&h[0]==n.$temp_insertion[0];if(f)return n.$most_recent_row_enter_add=null,!0;if(u)r.is_before(n.$temp_insertion)?r.before(n.$temp_insertion):r.is_after(n.$temp_insertion)?r.after(n.$temp_insertion):r.before(n.$temp_insertion),n.$master_container.trigger(n.boldgrid_modify_event);else if(m){if($first_child=r.find(">:first-child"),$direct_descendents=r.find("> div"),$first_child.length&&1===$direct_descendents.length&&0==$first_child.is(n.column_selectors_string+", .draggable-tools-imhwpb")&&$first_child.is("div"))$first_child.prepend(n.$temp_insertion);else{var s=n.before_or_after_drop(r,{x:e.originalEvent.clientX,y:e.originalEvent.clientY});"before"==s?r.prepend(n.$temp_insertion):r.append(n.$temp_insertion)}n.$master_container.trigger(n.boldgrid_modify_event)}}}else if(n.$current_drag.IMHWPB.is_column&&n.$current_drag.IMHWPB.unlock_column){if(n.recent_event&&n.recent_event.entered==r[0]&&n.recent_event.left==i[0])return!0;if(n.recent_event={entered:r[0],left:i[0]},n.insertion_time+20>(new Date).getTime())return!0;if(0==r.is(n.unformatted_column_selectors_string)&&0==r.is(n.row_selectors_string)){var p=r.closest_context(n.column_selectors_string,n.$master_container);p.length&&(r=p)}if(0==n.$master_container.has(r).length)return!0;if(r[0]==n.$temp_insertion[0])return;if(r.siblings().filter(n.$temp_insertion).length&&r.is(n.unformatted_column_selectors_string)&&r[0]!=n.$current_drag[0]){var v=t(e.target);if(r.find(v).length||r[0]==v[0])return!0}n.move_column_to(r)}}},record_drag_enter:function(e){n.$current_drag&&!n.$current_drag.IMHWPB.is_row&&(n.ie_version||e.preventDefault(),n.entered_target=t(e.target))}},this.get_ie_version=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE ");if(t>0)return parseInt(e.substring(t+5,e.indexOf(".",t)),10);var n=e.indexOf("Trident/");if(n>0){var i=e.indexOf("rv:");return parseInt(e.substring(i+3,e.indexOf(".",i)),10)}var r=e.indexOf("Edge/");return r>0?parseInt(e.substring(r+5,e.indexOf(".",r)),10):void 0},this.checkIsSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},this.move_column_to=function(e){var t=e.is(n.unformatted_column_selectors_string),i=e.is(n.$current_drag.properties.parent),r=e.closest_context(n.row_selectors_string,n.$master_container),o=n.$temp_insertion.closest_context(n.row_selectors_string,n.$master_container),a=n.find_row_size(r);if(r.length&&o[0]!=r[0]){if(i&&a>=n.max_row_size)return!1;var s=n.$temp_insertion[0].innerHTML;n.restore_row&&(o.html(n.restore_row),n.$temp_insertion.html(s));var l=n.$current_drag.IMHWPB.original_row!=r[0];l?n.restore_row=r.html():n.restore_row=null;var c=a+n.$current_drag.IMHWPB.column_size<=n.max_row_size;if(0==c&&l){var d=n.max_row_size-a,_=null,g=9;if(d>0)_=d;else if(r.find(n.immediate_column_selectors_string).length<=g){_=3,n.$current_drag.IMHWPB.column_size<_&&(_=n.$current_drag.IMHWPB.column_size);for(var m=0;m<_;m++)n.decrease_row_size(r)}if(!_)return n.restore_row=null,!0;n.change_column_size(n.$temp_insertion,null,_)}else n.change_column_size(n.$temp_insertion,null,n.$current_drag.IMHWPB.column_size);t?e.before(n.$temp_insertion):r.append(n.$temp_insertion),n.record_recent_column_insertion()}else t&&(e.is_before(n.$temp_insertion)?e.before(n.$temp_insertion):e.after(n.$temp_insertion),n.record_recent_column_insertion())},this.record_recent_column_insertion=function(){n.recent_event={},n.insertion_time=(new Date).getTime(),n.$master_container.trigger(n.boldgrid_modify_event)},this.prevent_duplicate_location_events=function(e){var t,i=[e.originalEvent.pageX,e.originalEvent.pageY];return n.array_equal(n.current_drag_enter_event_loc,i)?t=!0:(n.current_drag_enter_event_loc=i,t=!1),t},this.menu_actions={delete_element:function(e){e.preventDefault();var i=t(this).closest(".draggable-tools-imhwpb");i.next().remove(),i.remove(),n.$master_container.trigger(n.delete_event)},unnest_row:function(e){var i=t(this).closest(".draggable-tools-imhwpb").next();i.length&&(t(i[0].outerHTML).insertBefore(i.parent().closest(".row")),n.wp_media_modal_action(e,i))},nest_row:function(e){},nest_row_old:function(e){var i=t(this).closest(".draggable-tools-imhwpb").next();if(i.length){var r=i.prevAll(".row").eq(0);r.length||(r=i.nextAll(".row").eq(0)),r.length||(r=t('<div class="row"><div class="col-md-8"></div></div>'),n.$body.prepend(r));var o=r.find(n.general_column_selectors_string).eq(0);o.length||(o=t("<div class='col-md-8'></div>"),r.prepend(o)),o.prepend(i[0].outerHTML)}},add_row:function(e){var i=t('<div class="row"><div class="col-md-12"></div></div>');t(this).closest(".draggable-tools-imhwpb").before(i),i.addClass("added-element"),setTimeout(function(){n.$master_container.find(".added-element").removeClass("added-element")},1e3),n.$master_container.trigger(n.add_row_event,i.find(".col-md-12"))},add_column:function(e){e.preventDefault();var i,r=0,o=t(this),a=o.closest(".draggable-tools-imhwpb").next(),s=n.find_row_size(a),l=a.find("> *");if(1===l.length&&"BR"==l[0].tagName&&a.empty(),s<n.max_row_size&&s>=r)i=t('<div class="col-md-'+(n.max_row_size-s)+' col-sm-12 col-xs-12"></div>'),a.append(i);else if(s>=n.max_row_size){var c=n.get_layout_format(a),d=n.find_layout_transform(c);d&&!d.current?(n.transform_layout(a,d),i=t('<div class="col-md-'+d["new"]+' col-sm-12 col-xs-12"></div>'),a.append(i)):(n.decrease_row_size(a),i=t('<div class="col-md-1 col-sm-12 col-xs-12"></div>'),a.append(i))}i.html("<p><br> </p>"),i.addClass("added-element"),setTimeout(function(){i.removeClass("added-element")},1e3),n.$master_container.trigger(n.add_column_event,i),o.closest(".popover-menu-imhwpb").addClass("hidden")},duplicate:function(e){e.preventDefault();var i=t(this),r=i.closest(".draggable-tools-imhwpb").next(),o=n.get_element_type(r);if("row"==o||"content"==o){var a=r.clone();a[0].popover=null,r.after(a)}else if("column"==o){var s=r.closest_context(n.row_selectors_string,n.$master_container),l=n.find_column_size(r),c=n.get_layout_format(s),d=n.find_layout_transform(c,l),_=1;if(n.find_row_size(s)+l<=n.max_row_size){var g=r.before(r[0].outerHTML);g[0].popover=null}else if(d)if(d.current){n.change_column_size(r,null,d.current_transform),_=d["new"];var g=r.before(r[0].outerHTML);g[0].popover=null,n.change_column_size(g,null,_),t.each(d.additional_transform,function(e,i){var r=0;s.find(n.immediate_column_selectors_string).reverse().each(function(){if(!(r<i.count))return!1;var e=t(this);n.find_column_size(e)==i.from&&(n.change_column_size(e,null,i.to),r++)})})}else{n.transform_layout(s,d),_=d["new"];var g=r.before(r[0].outerHTML);g[0].popover=null,n.change_column_size(g,null,_)}else if(l%2==0&&l){n.change_column_size(r,null,parseInt(l/2));var g=r.before(r[0].outerHTML);g[0].popover=null,n.change_column_size(g,null,parseInt(l/2))}else if(n.decrease_row_size(s)){var g=r.before(r[0].outerHTML);g[0].popover=null,n.change_column_size(g,null,_)}}n.$master_container.trigger(n.add_column_event),i.closest(".popover-menu-imhwpb").addClass("hidden"),n.ie_version&&n.refresh_handle_location()},clear:function(e){e.preventDefault();var i=t(this),r=i.closest(".draggable-tools-imhwpb").next(),o=n.get_element_type(r);"column"==o?r.html("<p><br> </p>"):r.find(":not("+n.column_selectors_string+"):not( "+n.row_selectors_string+")").remove(),i.closest(".popover-menu-imhwpb").addClass("hidden"),n.$master_container.trigger(n.clear_event,r)},add_media:function(e){var i=t(this);n.add_media_event_handler(i.closest(".draggable-tools-imhwpb").next()[0])},insert_layout:function(e){var i=t(this);n.insert_layout_event_handler(i.closest(".draggable-tools-imhwpb").next()[0])},trigger_action_click:function(e){var i=t(this);l.indexOf(i.data("action"))===-1&&(n.$boldgrid_menu_action_clicked=i.closest(".draggable-tools-imhwpb").next()[0],n.wp_media_modal_action(e,i)),n.$master_container.trigger(n.boldgrid_modify_event)}},this.wp_media_modal_action=function(e,t){e.preventDefault(),t.closest(".popover-menu-imhwpb").addClass("hidden"),n.window_mouse_leave()},this.typing_events={start:function(){n.delete_popovers()},end:function(){n.update_handles(n.last_hover)}},this.resize_event_map={"mousemove.draggable":function(e,i){if(!n.resize){var r=n.pageX,o=!1;"undefined"!=typeof e&&null!=e&&(r=e.originalEvent.clientX,i=t(this),o=n.get_border_mouse_location(i,r)),o&&(o.left||o.right)?(i.addClass("resizing-imhwpb"),n.ie_version&&tinymce&&(tinymce.activeEditor.getBody().setAttribute("contenteditable",!1),tinymce.activeEditor.boldgridResize=!0)):(i.removeClass("resizing-imhwpb"),n.ie_version&&tinymce&&(tinymce.activeEditor.getBody().setAttribute("contenteditable",!0),tinymce.activeEditor.boldgridResize=!1))}n.$current_drag&&n.drag_handlers.end(e)},"mousedown.draggable":function(e){if($target=t(e.target),!$target.closest(".draggable-tools-imhwpb").length){var i=t(this),r=n.get_border_mouse_location(i,e.originalEvent.clientX),o=null;if(r.left?(o=i.prevAll(n.column_selectors_string).first(),i.addClass("resize-border-left-imhwpb")):r.right&&(o=i.nextAll(n.column_selectors_string).first(),i.addClass("resize-border-right-imhwpb")),r.left||r.right){o.length&&o.addClass("content-border-imhwpb"),n.$master_container.addClass("resizing-imhwpb"),n.$master_container.find(".resizing-imhwpb").removeClass("resizing-imhwpb"),n.remove_all_popovers();var a=n.$master_container.find("body");a.length||(a=n.$master_container),n.$master_container.trigger(n.resize_start_event),a.addClass("no-select-imhwpb"),n.resize={element:i,sibling:o,left:r.left,right:r.right}}}}},this};var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},function(e){"use strict";var t;BOLDGRID.EDITOR.Menu={$element:null,$activeElement:null,init:function(){return this.create(),this.setupMenuDrag(),this.$element},getTarget:function(e){return this.$element.targetData[e.name]},create:function(){this.$element=e(BoldgridEditor.instanceMenu),e("#mceu_34").append(this.$element)},setupMenuDrag:function(){this.$element.find("ul").draggable({containment:"#wp-content-editor-container",scroll:!1,axis:"x"})},createListItem:function(t){var n=e("<li></li>").attr("data-action","menu-"+t.name),i=e("<span></span>").addClass(t.iconClasses);n.append(i),this.$element.find("ul").append(n)},activateControl:function(e){t.deactivateControl(),this.$activeElement=BOLDGRID.EDITOR.Menu.$element.find('[data-action="menu-'+e.name+'"]').addClass("active")},deactivateControl:function(){this.$activeElement&&(this.$activeElement.removeClass("active"),this.$activeElement=null)},reactivateMenu:function(){var e=BOLDGRID.EDITOR.Panel.$element;this.$activeElement&&e.is(":visible")&&this.$element.find('[data-action="menu-'+e.attr("data-type")+'"]').addClass("active")}},t=BOLDGRID.EDITOR.Menu}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},function(e){"use strict";var t;BOLDGRID.EDITOR.Panel={$element:null,init:function(){return this.create(),this.onPanelClose(),this._setupDrag(),this.$element},create:function(){this.$element=e(BoldgridEditor.instancePanel),e("body").append(this.$element)},initScroll:function(){this.$element.find(".panel-body").slimScroll({color:"#32373c",size:"7px",height:this.$element.height()-66,wheelStep:5})},isOpenControl:function(e){var t=!1;return this.$element.is(":visible")&&this.$element.attr("data-type")==e.name&&(t=!0),t},_setupDrag:function(){this.$element.draggable({containment:"#wpwrap",handle:".panel-title",scroll:!1})},clearSelected:function(){BOLDGRID.EDITOR.Panel.$element.find(".selected").removeClass("selected")},setupPanelResize:function(){this.$element.resizable()},onPanelClose:function(){this.$element.on("click",".close-icon",function(){t.closePanel()})},closePanel:function(){t.$element.hide(),BOLDGRID.EDITOR.Menu.deactivateControl()},_scrollToSelected:function(){var e=t.$element.find(".selected");this.$element.find(".panel-body").scrollTop(0),e.length&&this.$element.find(".panel-body").scrollTop(e.position().top-t.$element.height()/2)},clear:function(){this.$element.find(".panel-title .name").empty(),this.$element.find(".panel-body").empty()},open:function(e){BOLDGRID.EDITOR.Menu.activateControl(e),this.$element.height(e.panel.height),this.$element.width(e.panel.width),this.$element.find(".panel-title .name").html(e.panel.title),this.$element.attr("data-type",e.name),this.$element.show(),this.initScroll(),this._scrollToSelected()}},t=BOLDGRID.EDITOR.Panel}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Background={name:"background",priority:80,iconClasses:"genericon genericon-gallery",selectors:[".boldgrid-section"],init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},panel:{title:"Background",height:"600px",width:"400px"},onMenuClick:function(e){t.openPanel()},openPanel:function(){var e=BOLDGRID.EDITOR.Panel;e.clear(),e.$element.find(".panel-body").html("<h1>Coming Soon</h1>"),e.open(t)}},BOLDGRID.EDITOR.CONTROLS.Background.init(),t=BOLDGRID.EDITOR.CONTROLS.Background}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Button={name:"button",priority:2,iconClasses:"fa fa-cog",selectors:[".boldgrid-button","a.button","a.button-secondary","a.button-primary"],classes:[{name:"boldgrid-button boldgrid-button-rounded boldgrid-button-flat"},{name:"boldgrid-button boldgrid-button-pill boldgrid-button-flat"},{name:"boldgrid-button boldgrid-button-flat"},{name:"boldgrid-button glow"},{name:"boldgrid-button boldgrid-button-rounded"},{name:"boldgrid-button boldgrid-button-3d"},{name:"boldgrid-button boldgrid-button-border"},{name:"boldgrid-button boldgrid-button-pill"},{name:"boldgrid-button boldgrid-button-circle"},{name:"boldgrid-button boldgrid-button-circle boldgrid-button-flat"}],init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},panel:{title:"Button Design",height:"400px",width:"350px"},setup:function(){t._setupPanelClick()},_setupPanelClick:function(){var n=BOLDGRID.EDITOR.Panel;n.$element.on("click",".button-design .panel-selection",function(){var i=e(this),r=i.data("preset"),o=BOLDGRID.EDITOR.Menu.getTarget(t);n.clearSelected(),i.addClass("selected"),o.attr("class",""),o.addClass(r)})},onMenuClick:function(e){t.openPanel()},openPanel:function(){var e=BOLDGRID.EDITOR.Panel,n=wp.template("boldgrid-editor-button");e.clear(),e.$element.find(".panel-body").html(n({text:"for sale",presets:t.classes})),e.open(t)}},BOLDGRID.EDITOR.CONTROLS.Button.init(),t=BOLDGRID.EDITOR.CONTROLS.Button}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Container={name:"container",priority:90,iconClasses:"fa fa-arrows-h",selectors:[".container"],init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},onMenuClick:function(e){var n=BOLDGRID.EDITOR.Controls.$menu.targetData[t.name].closest(".container, .container-fluid");n.hasClass("container")?(n.addClass("container-fluid"),n.removeClass("container")):(n.addClass("container"),n.removeClass("container-fluid"))}},BOLDGRID.EDITOR.CONTROLS.Container.init(),t=BOLDGRID.EDITOR.CONTROLS.Container}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Font={name:"font",priority:10,iconClasses:"fa fa-text-width",selectors:["p, h1, h2, h3, h4, h5, h6, table, section"],init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},panel:{title:"Font",height:"600px",width:"400px"},onMenuClick:function(e){t.openPanel()},openPanel:function(){var e=BOLDGRID.EDITOR.Panel;e.clear(),e.$element.find(".panel-body").html("<h1>Coming Soon</h1>"),e.open(t)}},BOLDGRID.EDITOR.CONTROLS.Font.init(),t=BOLDGRID.EDITOR.CONTROLS.Font}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Icon={name:"icon",priority:5,iconClasses:"fa fa-cog",selectors:[".fa"],panel:{title:"Change Icon",height:"400px",width:"335px"},init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},elementClick:function(){t.openPanel()},setupPanelClick:function(){var n=BOLDGRID.EDITOR.Controls,i=BOLDGRID.EDITOR.Panel;i.$element.on("click",".panel-selection",function(){var r=n.$menu,o=r.targetData[t.name],a=e(this);o.removeClass(function(e,t){return(t.match(/(^|\s)fa-\S+/g)||[]).join(" ")}),o.addClass(a.find("i").attr("class")),i.$element.find(".selected").removeClass("selected"),a.addClass("selected")})},onMenuClick:function(){t.openPanel()},openPanel:function(){var n,i=BOLDGRID.EDITOR.Panel.$element,r=BOLDGRID.EDITOR.Controls.$menu,o=r.targetData[t.name];t.setupPanelClick();var a=e("<ul></ul>");e.each(BoldgridEditor.icons,function(){var t=e('<li class="panel-selection"><i class="'+this["class"]+'"></i><span class="name">'+this.name+"</span></li>");a.append(t)}),i.find(".panel-body").html(a),i.find(".selected").removeClass("selected"),n=i.find('i[class="'+o.attr("class")+'"]').closest(".panel-selection").addClass("selected"),BOLDGRID.EDITOR.Panel.open(t)}},BOLDGRID.EDITOR.CONTROLS.Icon.init(),t=BOLDGRID.EDITOR.CONTROLS.Icon}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.ImageFilter={name:"image-filter",priority:5,iconClasses:"genericon genericon-image",sliderHistory:{},preview:null,presetIntensity:"50%",panel:{title:"Image Filters",height:"536px",width:"800px"},selectors:["img"],presets:[{name:"none",title:"None"},{name:"vintage",title:"Vintage"},{name:"lomo",title:"Lomo"},{name:"clarity",title:"Clarity"},{name:"sinCity",title:"Sin City"},{name:"sunrise",title:"Sunrise"},{name:"crossProcess",title:"Cross Process"},{name:"orangePeel",title:"Orange Peel"},{name:"love",title:"Love"},{name:"grungy",title:"Grungy"},{name:"jarques",title:"Jarques"},{name:"pinhole",title:"Pinhole"},{name:"oldBoot",title:"Old Boot"},{name:"glowingSun",title:"Glowing Sun"},{name:"hazyDays",title:"Hazy Days"},{name:"herMajesty",title:"Her Majesty"},{name:"nostalgia",title:"Nostalgia"},{name:"hemingway",title:"Hemingway"},{name:"concentrate",title:"Concentrate"}],customizeSettings:{brightness:{title:"Brightness",range:{min:-50,max:50}},vibrance:{title:"Vibrance",range:{min:-50,max:50}},contrast:{title:"Contrast",range:{min:-10,max:10}},saturation:{title:"Saturation",range:{min:-50,max:50}},exposure:{title:"Exposure",range:{min:-50,max:50}},hue:{title:"Hue",range:{min:0,max:100}},gamma:{title:"Gamma",range:{min:1,max:4,val:1}},clip:{title:"Clip",range:{min:0,max:50}},stackBlur:{title:"Blur",range:{min:0,max:30}},sepia:{title:"Sepia",range:{min:0,max:100}},noise:{title:"Noise",range:{min:0,max:50}},sharpen:{title:"Sharpen",range:{min:0,max:50}}},init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},setup:function(){t._setupInsertClick(),t._setupToggleCustomize(),t._setupPanelClick()},_setupToggleCustomize:function(){var e,n=BOLDGRID.EDITOR.Panel;BOLDGRID.EDITOR.Menu;n.$element.on("click",".presets .activate-customize",function(){n.$element.find(".choices").addClass("customizing"),t.preview.revert(),t.applySliderSettings()}),n.$element.on("click",".customize .activate-presets",function(){n.$element.find(".choices").removeClass("customizing"),t.preview.revert(),e=n.$element.find(".selected").data("preset"),e?t.renderPreset(e):(n.clearSelected(),n.$element.find('[data-preset="none"]').addClass("selected"))})},renderPreset:function(e){var n=BOLDGRID.EDITOR.Panel;n.$element.addClass("rendering"),t.preview.revert(!1),t.preview[e](t.presetIntensity).render(function(e){n.$element.removeClass("rendering")})},_setupPanelClick:function(){var n=BOLDGRID.EDITOR.Panel;BOLDGRID.EDITOR.Menu;n.$element.on("click",".image-filter .panel-selection",function(){var i=e(this),r=(n.$element.find(".preview").find("img, canvas"),i.data("preset"));n.clearSelected(),i.addClass("selected"),"none"!=r?t.renderPreset(r):t.preview.revert()})},_setupInsertClick:function(){BOLDGRID.EDITOR.Panel.$element.on("click",".preview .insert-image",function(){t.insertImage()})},_setupSliders:function(){t.sliderHistory={},BOLDGRID.EDITOR.Panel.$element.find(".slider").each(function(){var n=e(this),i=n.data("control"),r=t.customizeSettings[i].range;n.slider({min:r.min,max:r.max,value:r.val||0,change:function(e,n){t.sliderHistory[i]=n.value,t.applySliderSettings()}})})},applySliderSettings:function(){t.preview.revert(!1),e.each(t.sliderHistory,function(e){t.preview[e](this)}),t.preview.render()},insertImage:function(){var n=BOLDGRID.EDITOR.Panel,i=BOLDGRID.EDITOR.Menu.getTarget(t);n.$element.addClass("rendering"),e.ajax({type:"post",url:ajaxurl,dataType:"json",data:{action:"boldgrid_canvas_image",attachement_id:i.attachment_id,image_data:t.preview.canvas.toDataURL()},success:function(e){e&&e.success&&(i.removeClass("wp-image-"+i.attachment_id),i.addClass("wp-image-"+e.attachment_id),i.attachment_id=e.attachment_id,
i.attr("src",e.url),i.attr("data-mce-src",e.url),BoldgridEditor.images=e.images)}}).always(function(){n.$element.removeClass("rendering")})},elementClick:function(){BOLDGRID.EDITOR.Panel.isOpenControl(this)&&t.openPanel()},_renderPanelThumbnails:function(){var e,n=1;(e=function(){Caman('[data-preset="'+t.presets[n].name+'"] img',function(){this[t.presets[n].name]("50%").render(function(){n++,t.presets[n]&&e()})})})()},get_image_src:function(){var n,i=BOLDGRID.EDITOR.Menu.getTarget(t),r=i.attr("src");return e.each(BoldgridEditor.images,function(){if(i.hasClass("wp-image-"+this.attachment_id))return i.attachment_id=this.attachment_id,n=this.thumbnail,!1}),n||(n=r),{src:n,fullSrc:r}},openPanel:function(){var e,n=BOLDGRID.EDITOR.Panel,i=wp.template("boldgrid-editor-image-filter");n.clear(),e=this.get_image_src(),n.$element.find(".panel-body").html(i({fullSrc:e.fullSrc,src:e.src,presets:t.presets,customizeSettings:t.customizeSettings})),t._setupSliders(),t._renderPanelThumbnails(),n.$element.find('[data-preset="none"]').addClass("selected"),t.preview=Caman(n.$element.find(".preview img")[0]),tinyMCE.activeEditor.selection.collapse(!1),n.open(t)},onMenuClick:function(){t.openPanel()}},BOLDGRID.EDITOR.CONTROLS.ImageFilter.init(),t=BOLDGRID.EDITOR.CONTROLS.ImageFilter}(jQuery);var BOLDGRID=BOLDGRID||{};BOLDGRID.EDITOR=BOLDGRID.EDITOR||{},BOLDGRID.EDITOR.CONTROLS=BOLDGRID.EDITOR.CONTROLS||{},function(e){"use strict";var t;BOLDGRID.EDITOR.CONTROLS.Image={classes:[{name:"boldgrid-image img-mod-1"},{name:"boldgrid-image img-mod-9"},{name:"boldgrid-image img-mod-2"},{name:"boldgrid-image img-mod-3"},{name:"boldgrid-image img-mod-6"},{name:"boldgrid-image img-mod-5"},{name:"boldgrid-image img-mod-4"},{name:"boldgrid-image img-mod-7"},{name:"boldgrid-image img-mod-8"},{name:"boldgrid-image img-mod-10"}],name:"image",priority:2,iconClasses:"fa fa-cog",selectors:["img"],init:function(){BOLDGRID.EDITOR.Controls.registerControl(this)},panel:{title:"Image Design",height:"500px",width:"340px"},onMenuClick:function(e){t.openPanel()},elementClick:function(){BOLDGRID.EDITOR.Panel.isOpenControl(this)&&t.openPanel()},setup:function(){t._setupPanelClick()},_setupPanelClick:function(){var n=BOLDGRID.EDITOR.Panel;n.$element.on("click",".image-design .panel-selection",function(){var i=e(this),r=i.data("preset"),o=BOLDGRID.EDITOR.Menu.getTarget(t);n.clearSelected(),i.addClass("selected"),o.removeClass(function(e,t){return(t.match(/(^|\s)img-mod-\S+/g)||[]).join(" ")}).addClass(r),tinyMCE.activeEditor.selection.collapse(!1)})},openPanel:function(){var n=BOLDGRID.EDITOR.Panel,i=BOLDGRID.EDITOR.Menu.getTarget(t),r=wp.template("boldgrid-editor-image");n.clear(),n.$element.find(".panel-body").html(r({src:i.attr("src"),presets:t.classes})),e.each(t.classes,function(){i.hasClass(this.name)&&n.$element.find('[data-preset="'+this.name+'"]').addClass("selected")}),n.open(t)}},BOLDGRID.EDITOR.CONTROLS.Image.init(),t=BOLDGRID.EDITOR.CONTROLS.Image}(jQuery),function(e){"use strict";e.fourpan||(e.fourpan=function(t,n){var i=this;if(!e.fourpan.initiated){var r;t?(r=e(t).find("html"),r.length||(r=e(t).closest("html"))):r=e("html");var o="fourpan-overlays",a=!1,s={},l=e.extend({},e.fourpan.defaultOptions,n),c=o+" "+l.overlay_classes,d=e('<div class="forpan-close-button">Close</div>');d.css({position:"absolute","z-index":"10000","font-size":"20px",background:"rgb(213, 78, 33)","border-radius":"6px",padding:"6px 13px","text-shadow":"1px 1px 0 #222",color:"white",display:"none"}).on("mouseenter",function(){e(this).css({"background-color":"#f95b26",cursor:"pointer"})}).on("mouseleave",function(){e(this).css({"background-color":"rgb(213, 78, 33)",cursor:"default"})}),r.append(d);var _=function(){s[l.id_prefix+"-top"]={},s[l.id_prefix+"-right"]={},s[l.id_prefix+"-bottom"]={},s[l.id_prefix+"-left"]={},e.fourpan.initiated=!0,g(),u()},g=function(){e.each(s,function(e){var t=r.find("#"+e);t.length?s[e]=t:(t=m(e),s[e]=t)})},m=function(t){var n=e('<div id="'+t+'" class="'+c+'"></div>');return r.append(n),n},u=function(){r.find("."+o).add(d).on("click",h),r.keyup(function(e){27==e.keyCode&&h()})},h=function(){r.find("."+o).add(d).fadeOut(),a=!1,l.deactivate(),v()},f=function(){var e=r.find("."+o);e.css({position:"absolute",top:"0",right:"0",bottom:"0",left:"0","z-index":"9999","background-color":l.color}),a=!0};e.fourpan.dismiss=function(){h()};var p=function(){r.find("body").on("DOMSubtreeModified.fourpan",function(t){i.time=t.timeStamp,setTimeout(function(){var t=(new Date).getTime();(!i.last_event||i.last_event<t-250)&&(i.last_event=t,e.fourpan.refresh())},250)})},v=function(){r.find("body").off(".fourpan")},b=function(e,t,n,i){t>0&&d.hide();var a=e[0].getBoundingClientRect();s[l.id_prefix+"-top"].stop().animate({height:Math.max(a.top-n,0)},t),s[l.id_prefix+"-right"].stop().animate({top:Math.max(a.top-n,0),left:a.left+e.outerWidth()+n},t),s[l.id_prefix+"-bottom"].stop().animate({top:a.top+e.outerHeight()+n,width:a.left+e.outerWidth()+n},t);var c=Math.max(a.top-n,0)-(a.top-n);s[l.id_prefix+"-left"].stop().animate({width:Math.max(a.left-n,0),top:Math.max(a.top-n,0),height:e.outerHeight()+2*n-c},{duration:t,complete:function(){i&&d.css({left:a.left+(e.outerWidth()+n)/2-35,top:a.top+e.outerHeight()+n+20}).fadeIn(),r.find("."+o).fadeIn()}})};return e.fourpan.highlight=function(t){if(t instanceof jQuery){if(t.length>1||!t.length)return!1;var n=t}else var n=e(t);return 1===n.length&&n.is(":visible")?(e.fourpan.$recent_highlight=n,0==a&&(f(),l.activate(),p(),r.find("."+o).hide()),b(n,l.transition_speed,l.element_padding,!0),!0):(h(),!1)},e.fourpan.refresh=function(){a&&(r.find(e.fourpan.$recent_highlight).length?(b(e.fourpan.$recent_highlight,0,l.element_padding,!0),i.last_event=(new Date).getTime()):h())},_(),r}},e.fourpan.defaultOptions={id_prefix:"fourpan-overlay",overlay_classes:"",color:"rgba(0,0,0,.7)",transition_speed:1e3,element_padding:20,activate:function(){},deactivate:function(){}},e.fn.fourpan=function(t){return this.each(function(){new e.fourpan(this,t)})})}(jQuery),function(e){e.fn.is_typing_boldgrid=function(){var t=this,n=e(this);jQuery.Event("end_typing_boldgrid"),jQuery.Event("start_typing_boldgrid");var i=1e3;this.is_typing=!1;var r,o=function(e){0==t.is_typing&&(t.is_typing=!0,n.trigger("start_typing_boldgrid")),r=(new Date).getTime();var o=function(e){r==e&&(t.is_typing=!1,n.trigger("end_typing_boldgrid"))};setTimeout(o,i,r)};return e(this).on("keydown",o),this}}(jQuery),function(e){e.fn.textSelect=function(t,n){var i,r,o,a,s=250,l=function(e){!o&&r&&i+s<e.timeStamp&&(a=e.timeStamp,o=!0,t())},c=function(e){r=!1,o=!1,n()},r=function(e){var t=e.originalEvent.originalTarget||e.originalEvent.srcElement;if(t){var n=jQuery(t);n.is('[draggable="true"]')||n.closest('[draggable="true"]').length||n.is('[unselectable="on"]')||n.closest('[unselectable="on"]').length||(i=e.timeStamp,r=!0)}};e(this).on("mousedown",r).on("mouseup dragend drop",c).on("mousemove",l)}}(jQuery);var IMHWPB=IMHWPB||{};IMHWPB.Editor=function(e){var t=this;this.media_default_bound=!1;var n=e(window);this.row_selector_string="",this.content_selector_string="",this.column_selector_string="",this.currently_selected_size=null,this.crop=new BoldgridEditor.crop(e),this.select_alignment=function(){var n=e(tinymce.activeEditor.selection.getNode()),i=e(".attachments-browser select.alignment"),r=e(".attachments-browser select.link-to");if(0==t.media_default_bound&&(t.media_default_bound=!0,wp.media.frame.on("open",t.select_alignment)),n.is("img")){var o=n.attr("class"),a=[];o&&(a=n.attr("class").split(/\s+/));var s="none";e.each(a,function(e,t){return"aligncenter"==t?(s="center",!1):"alignnone"==t?(s="none",!1):"alignright"==t?(s="right",!1):"alignleft"==t?(s="left",!1):void 0});var l=null,c=n.parent("a");c.length||(l="none"),r.length&&l&&r.val(l).change(),i.length&&i.val(s).change()}},this.select_default_alignment=function(){e(document).on("click",".attachments-browser .attachment",t.select_alignment)},this.draggable=function(){var e=null;return IMHWPB.WP_MCE_Draggable&&IMHWPB.WP_MCE_Draggable.instance&&(e=IMHWPB.WP_MCE_Draggable.instance.draggable_instance),e},this.override_insert_media=function(){var t=send_to_editor;send_to_editor=function(n){var i=[];if(!n.match(/^\[.+?\]/))var r=e(tinymce.activeEditor.selection.getContent()),o=e(n),a=o.is("img")||o.is("a")&&o.find("*").is("img");if(a&&r.is("img")&&o.find("img").length<=1){var s=[],l=r.attr("class"),c=[];l&&(c=l.split(/\s+/));var d=r.attr("width"),_=r.attr("height");e.each(c,function(e,t){t.match(/size-/)||t.match(/align/)||t.match(/wp-image-/)||s.push(t)});var g=null;if(o.is("img"))var g=o;else var g=o.find("img");e.each(s,function(e,t){g.addClass(t)}),g.attr("height",_).attr("width",d);var m=e(tinymce.activeEditor.selection.getNode()),u=m.parent();if(u.length&&"A"==u[0].tagName&&(m=u),m.replaceWith(o[0].outerHTML),tinymce.activeEditor.fire("setContent"),tinymce.activeEditor.focus(),tinymce.activeEditor.execCommand("mceAddUndoLevel"),window.tb_remove)try{window.tb_remove()}catch(h){}}else i.push(n),t.apply(this,i)}},e(function(){t.select_default_alignment(),t.original_column_val=e('[name="screen_columns"]:checked').val(),tinymce.PluginManager.add("monitor_view_imhwpb",function(n,i){n.addButton("monitor_view_imhwpb",{title:"Desktop View",icon:"icon dashicons dashicons-desktop imhwpb-icon",classes:"displaysize-imhwpb widget btn boldgrid-desktop",onclick:function(n){t.activate_display("monitor",e(n.target))}})}),tinymce.PluginManager.add("tablet_view_imhwpb",function(n,i){n.addButton("tablet_view_imhwpb",{title:"Tablet View",icon:"icon dashicons dashicons-tablet imhwpb-icon",classes:"displaysize-imhwpb widget btn boldgrid-tablet",onclick:function(n){t.activate_display("tablet",e(n.target))}})}),tinymce.PluginManager.add("phone_view_imhwpb",function(n,i){n.addButton("phone_view_imhwpb",{title:"Phone View",icon:"icon dashicons dashicons-smartphone imhwpb-icon",classes:"displaysize-imhwpb widget btn boldgrid-phone",onclick:function(n){t.activate_display("phone",e(n.target))}})}),tinymce.PluginManager.add("toggle_draggable_imhwpb",function(n,i){t.override_insert_media(),n.addButton("toggle_draggable_imhwpb",{title:"BoldGrid Editing",icon:"icon genericon genericon-move",classes:"widget btn",onclick:t.toggle_draggable_plugin}),n.on("BeforeAddUndo",function(e){if(1==IMHWPB.tinymce_undo_disabled)return!1}),n.on("SetContent",function(n){t.reset_anchor_spaces(tinymce.activeEditor.getBody(),!0),e.fourpan&&e.fourpan.refresh&&e.fourpan.refresh(),"html"==n.format&&t.dragging_is_active()&&(n.set||IMHWPB.WP_MCE_Draggable.instance.draggable_instance.validate_markup(),IMHWPB.WP_MCE_Draggable&&IMHWPB.WP_MCE_Draggable.instance&&IMHWPB.WP_MCE_Draggable.instance.refresh_iframe_height&&setTimeout(function(){IMHWPB.WP_MCE_Draggable.instance.refresh_iframe_height()},500))}),n.on("KeyDown",function(i){if(!t.draggable)return!0;var r=e(tinymce.activeEditor.selection.getNode()),o=r.is(t.draggable.column_selectors_string),a=r.is(t.draggable.row_selectors_string),s=r.is("A");if(o||a){if(i.which>=48&&i.which<=90||i.which>=96&&i.which<=105){if(0==r.is(":empty")&&0!==r.find("> br").siblings().length)return;if(o)var l=e("<p></p>"),c=l;else var c=e('<div class="col-md-12"><p></p></div>'),l=c.find("p");r.html(c),n.selection.setCursorLocation(l[0],0)}}else if(s&&!("8"!=i.which&&"46"!=i.which||"&nbsp;&nbsp;"!=r.html()&&"&nbsp; "!=r.html()))return r.remove(),!1;return!0}),n.on("NodeChange",function(t){var i=e(t.element);if("A"==t.element.tagName){var r=tinymce.DOM.createRng(),o=tinymce.activeEditor.selection.getRng(),a=null;if(o.startOffset==o.endOffset)if(0===o.startOffset)("&nbsp;"==t.element.firstChild.data.substr(0,6)||/\s/.test(t.element.firstChild.data.substr(0,1)))&&(a=1);else if(t.element.firstChild&&o.startOffset==t.element.firstChild.length){var s=0;("&nbsp;"==t.element.firstChild.data.substr(-6)||/\s/.test(t.element.firstChild.data.substr(-1)))&&(s=-1),a=t.element.firstChild.length+s}a&&(r.setStart(t.element.firstChild,a),r.setEnd(t.element.firstChild,a),tinymce.activeEditor.selection.setRng(r))}t.selectionChange&&i.length&&i.is("br")&&i.parent().children().each(function(){var t=e(this);if(t.is("a")&&t.html()&&!t.find("img").length)return $new_element=t.find(":first"),$new_element.length||($new_element=t),n.selection.setCursorLocation($new_element[0],1),!1})}),n.on("SetAttrib",function(e){if(e.attrElm.hasClass("wpview-wrap")&&"undefined"!=typeof IMHWPB.WP_MCE_Draggable.instance){var t=IMHWPB.WP_MCE_Draggable.instance.draggable_instance;t.resize&&t.$master_container.trigger("mouseup",e.attrElm)}}),n.on("mousedown",function(n){if(t.draggable){var i,r=e(n.target),o=!0===tinymce.activeEditor.boldgridResize,a=r.closest(".draggable-tools-imhwpb").length,s=!t.draggable.ie_version&&r.hasClass("action-list")&&!r.attr("draggable"),l=a&&!s;(l||o)&&(n.button=!0,n.preventDefault=function(){},i=e("<div><div></div></div>"),i[0].contentEditable=!1,n.target=i[0])}}),n.on("dragstart",function(t){var n=e(t.originalTarget);n.hasClass("popover-imhwpb")&&t.preventDefault()}),n.on("ObjectResizeStart",function(e){"undefined"!=typeof IMHWPB.WP_MCE_Draggable.instance.draggable_instance.$master_container&&(IMHWPB.WP_MCE_Draggable.instance.draggable_instance.popovers_disabled=!0,IMHWPB.WP_MCE_Draggable.instance.draggable_instance.$master_container.find(".draggable-tools-imhwpb").addClass("hidden"))}),n.on("ObjectResized",function(e){"undefined"!=typeof IMHWPB.WP_MCE_Draggable.instance.draggable_instance.$master_container&&(IMHWPB.WP_MCE_Draggable.instance.draggable_instance.popovers_disabled=!1,IMHWPB.WP_MCE_Draggable.instance.draggable_instance.$master_container.find(".draggable-tools-imhwpb").removeClass("hidden"))}),n.on("GetContent",function(e){if(e.content&&(e.content=t.reset_anchor_spaces("<div>"+e.content+"</div>",!1),IMHWPB.WP_MCE_Draggable.instance&&IMHWPB.WP_MCE_Draggable.instance.draggable_instance&&(e.content=IMHWPB.WP_MCE_Draggable.instance.draggable_instance.frame_cleanup(e.content)),e.save)){var n=jQuery("<div>"+e.content+"</div>"),i=n.find("> *:last");if(i.is("p")){var r=i.text(),o=i.html();(" "==r||"<br>"==o&&!r||"&nbsp;"==o)&&(i.remove(),e.content=n.html())}}}),n.on("Undo Redo",function(e){IMHWPB.WP_MCE_Draggable.instance.refresh_iframe_height()}),n.on("init",function(n){IMHWPB.WP_MCE_Draggable.instance=new IMHWPB.WP_MCE_Draggable,setTimeout(function(){IMHWPB.WP_MCE_Draggable.instance.refresh_iframe_height()},1e3),setTimeout(function(){IMHWPB.WP_MCE_Draggable.instance.refresh_iframe_height()},3e3);var i=e(n.target.iframeElement).contents();BoldgridEditor.body_class&&i.find("body").addClass(BoldgridEditor.body_class),BoldgridEditor.hasDraggableEnabled?(IMHWPB.WP_MCE_Draggable.instance.load_draggable(i),t.draggable=IMHWPB.WP_MCE_Draggable.instance.draggable_instance,t.draggable.ie_version&&t.draggable.ie_version<=11&&i.find("body").addClass("dragging-disabled")):(IMHWPB.WP_MCE_Draggable.instance.set_style_sheet_inactive("draggable",!0,e(n.target.iframeElement).contents().get(0)),IMHWPB.WP_MCE_Draggable.instance.draggable_inactive=!0);var r=i.find("body > *:last");r.is("p")&&1==r.children().length||i.find("body").append("<p> </p>"),t.button_created=!1,tinymce.activeEditor.on("wptoolbar",function(e){if(0==t.button_created&&e.toolbar){var n=[];n.push(tinymce.ui.Factory.create({type:"button",title:"Change",tooltip:"Change",icon:"icon dashicons dashicons-admin-media imhwpb-icon",onclick:function(){tinymce.activeEditor.buttons.wp_img_edit.onclick(),wp.media.frame.setState("replace-image"),wp.media.frame.state("replace-image").on("replace",function(e){t.crop.onReplace(e)})}})),e.toolbar._items[0]._items[0].insert(n,3,!1),e.toolbar.reposition(),t.button_created=!0}})})})}),this.mce_element_is_empty=function(e){var t=e.children(),n=!1;return(e.is(":empty")||1==t.length&&t.filter("br").length&&!e.text())&&(n=!0),n},this.reset_anchor_spaces=function(t,n){var i=e(t);return i.find("a").each(function(){var t=e(this),i=t.html();"&nbsp;"==i.substr(0,6)&&(i=i.substr(6)),"&nbsp;"==i.substr(-6,6)&&(i=i.substr(0,i.length-6)),n?t.html("&nbsp;"+i+"&nbsp;"):t.html(i)}),i.html()},this.dragging_is_active=function(){return"undefined"!=typeof IMHWPB.WP_MCE_Draggable.instance&&0==IMHWPB.WP_MCE_Draggable.instance.draggable_inactive},this.toggle_draggable_plugin=function(e){"undefined"!=typeof IMHWPB.WP_MCE_Draggable&&"undefined"!=typeof IMHWPB.WP_MCE_Draggable.instance&&IMHWPB.WP_MCE_Draggable.instance.toggle_draggable_plugin(e)},this.activate_display=function(i,r){var o=r.closest("div");return!o.hasClass("mce-disabled")&&(e(".mce-displaysize-imhwpb").removeClass("boldgrid-highlighted-mce-icon"),o.hasClass("mce-active")?(r.closest("div").removeClass("mce-active"),t.remove_editor_styles(),t.currently_selected_size=null):(e(".mce-displaysize-imhwpb").each(function(){e(this).closest("div").removeClass("mce-active")}),r.closest("div").addClass("mce-active"),t.set_width(i),t.currently_selected_size=i),void(IMHWPB.WP_MCE_Draggable.instance&&0==IMHWPB.WP_MCE_Draggable.instance.draggable_inactive&&(IMHWPB.WP_MCE_Draggable.instance.resize_done_event(null,!0),n.trigger("resize"))))},this.remove_editor_styles=function(){e("#wp-content-editor-container").removeClass("mce-viewsize-phone-imhwpb mce-viewsize-tablet-imhwpb mce-viewsize-monitor-imhwpb")},this.set_width=function(n){t.remove_editor_styles(),e("#wp-content-editor-container").addClass("mce-viewsize-"+n+"-imhwpb")}},IMHWPB.Editor.instance=new IMHWPB.Editor(jQuery);var IMHWPB=IMHWPB||{};IMHWPB.WP_MCE_Draggable=function(){var e=this,t=jQuery;this.resize_selector=".mce-resizehandle",this.draggable_instance=!1;var n=t(window);this.draggable_inactive=!1,this.last_resize=null,this.phone_width_needed=620,this.tablet_width_needed=1250,this.desktop_width_needed=1270,this.bootstrap_container=null;var i=[];this.bind_window_resize=function(){n.on("resize",function(){0==e.draggable_inactive&&(e.last_resize=(new Date).getTime(),setTimeout(e.resize_done_event,250,e.last_resize))})},this.highlight_screen_size=function(n){e.remove_icon_highlights(),t(".mce-boldgrid-"+n).addClass("boldgrid-highlighted-mce-icon")},this.remove_icon_highlights=function(){t(".mce-displaysize-imhwpb").removeClass("boldgrid-highlighted-mce-icon")};var r=t.Event("BoldGridPreInit");this.load_draggable=function(n){0==e.draggable_instance&&(t(document).trigger(r,this),IMHWPB.WP_MCE_Draggable.draggable_instance=n.IMHWPB_Draggable({dragImage:"actual",add_media_event_handler:e.add_media_action,insert_layout_event_handler:e.insert_layout_action,menu_items:i,main_container:!0},t).init(),e.draggable_instance=IMHWPB.WP_MCE_Draggable.draggable_instance),tinymce.activeEditor.controlManager.setActive("toggle_draggable_imhwpb",!0),e.bind_events()},this.add_media_action=function(){e.insert_from_media_modal_tab("insert")},this.insert_from_media_modal_tab=function(t){tinymce.activeEditor.selection.setCursorLocation(e.draggable_instance.$boldgrid_menu_action_clicked,0),wp.media.editor.open(),wp.media.frame.setState(t)},this.insert_layout_action=function(){e.insert_from_media_modal_tab("iframe:insert_layout")},this.set_button_cursor=function(n){if(n.clientX){var i=t(this),r=e.draggable_instance.$master_container.find("button:not([data-mce-bogus])").not(i);e.replace_all_buttons(r),tinymce.activeEditor.selection.setCursorLocation(this,1)}},this.replace_all_buttons=function(e){e.each(function(){var e=this.outerHTML;t(this).replaceWith(e)})},this.bind_events=function(){e.draggable_instance.$master_container.on("mousedown.draggable_mce",".draggable-tools-imhwpb",e.boldgrid_tool_click).on("mouseup.draggable_mce",".draggable-tools-imhwpb",e.boldgrid_tool_click).on("add_column_dwpb.draggable_mce",e.add_column_done).on("drag_start_dwpb.draggable_mce",e.drag_start).on("delete_dwpb.draggable_mce",e.delete_element).on("drag_end_dwpb.draggable_mce",e.drag_end_event).on("add_row_event_dwpb.draggable_mce",e.set_cursor).on("boldgrid_edit_row.draggable_mce",e.edit_row).on("click.draggable_mce","button:not([data-mce-bogus])",e.set_button_cursor).on("click.draggable_mce","a",function(e){e.preventDefault()}).on("resize_start_dwpb.draggable_mce",e.prevent_edit).on("resize_done_dwpb.draggable_mce",e.column_resize_done).on("boldgrid_modify_content.draggable_mce",e.boldgrid_modify_content),e.draggable_instance.$master_container.textSelect(e.text_select_start,e.text_select_end)},this.boldgrid_modify_content=function(){e.refresh_iframe_height()},this.delete_element=function(){e.add_tiny_mce_history(),e.refresh_iframe_height()},this.drag_start=function(){tinymce.activeEditor.getBody().setAttribute("contenteditable",!1),tinyMCE.activeEditor.selection.collapse(!1),e.end_undo_level_mce(),e.draggable_instance.$master_container.find("html").addClass("drag-progress")},this.text_select_start=function(){e.draggable_instance.$master_container.find("html").addClass("selecting")},this.text_select_end=function(){e.draggable_instance.$master_container.find("html").removeClass("selecting")},this.set_cursor=function(e,t){tinymce.activeEditor.selection.setCursorLocation(t,0)},this.prevent_edit=function(){tinyMCE.activeEditor.selection.collapse(!1),e.draggable_instance.ie_version||tinymce.activeEditor.getBody().setAttribute("contenteditable",!1)},this.end_undo_level_mce=function(){IMHWPB.tinymce_undo_disabled=!0},this.drag_end_event=function(t,n){tinymce.activeEditor.getBody().setAttribute("contenteditable",!0),IMHWPB.tinymce_undo_disabled=!1,e.add_tiny_mce_history(),e.initialize_gallery_objects(e.draggable_instance.$master_container),e.draggable_instance.$master_container.find("html").removeClass("drag-progress"),tinymce&&tinymce.activeEditor.selection&&n&&tinymce.activeEditor.selection.setCursorLocation(n,0)},this.column_resize_done=function(){e.draggable_instance.ie_version||tinymce.activeEditor.getBody().setAttribute("contenteditable",!0),n.trigger("resize")},this.refresh_iframe_height=function(){var e=tinymce.activeEditor.getBody().getBoundingClientRect().height+100;e>700&&t(tinymce.activeEditor.iframeElement).css("height",e+"px")},this.add_column_done=function(t,n){e.add_tiny_mce_history(),e.initialize_gallery_objects(e.draggable_instance.$master_container),tinymce.activeEditor.selection.setCursorLocation(n,0)},this.add_tiny_mce_history=function(){tinymce.activeEditor.execCommand("mceAddUndoLevel")},this.initialize_gallery_objects=function(e){"undefined"!=typeof IMHWPBGallery&&"undefined"!=typeof IMHWPBGallery.init_gallery&&(e.find(".masonry").removeClass("masonry"),IMHWPBGallery.init_gallery(e))},this.boldgrid_tool_click=function(){e.remove_mce_resize_handles(),e.draggable_instance.ie_version||(tinyMCE.activeEditor.selection.select(tinyMCE.activeEditor.getBody(),!0),tinyMCE.activeEditor.selection.collapse(!1))},this.remove_mce_resize_handles=function(){e.draggable_instance.$master_container.find("[data-mce-selected]").removeAttr("data-mce-selected"),e.draggable_instance.$master_container.find(".mce-resizehandle").remove(),t(".mce-wp-image-toolbar").hide(),e.draggable_instance.$master_container.find(e.resize_selector).hide()},this.toggle_draggable_plugin=function(i){var r=t(tinymce.activeEditor.iframeElement).contents().get(0);e.draggable_inactive=e.set_style_sheet_inactive("draggable",!e.draggable_inactive,r);var o;"undefined"!=typeof i&&(o=t(i.target)),e.draggable_inactive?(e.remove_icon_highlights(),e.draggable_instance.unbind_all_events(),o&&o.closest("div").removeClass("mce-active"),0==BoldgridEditor.is_boldgrid_theme&&(IMHWPB.Editor.instance.remove_editor_styles(),t('[name="screen_columns"][value="'+IMHWPB.Editor.instance.original_column_val+'"]').click())):(o&&o.closest("div").addClass("mce-active"),e.draggable_instance.bind_events?(e.draggable_instance.bind_events(),e.bind_events()):e.load_draggable(t(tinymce.activeEditor.iframeElement).contents())),e.saveDraggableState(!e.draggable_inactive),n.trigger("resize")},this.saveDraggableState=function(e){t.post(ajaxurl,{action:"boldgrid_draggable_enabled",draggable_enabled:e?1:0,security:BoldgridEditor.draggableEnableNonce})},this.set_style_sheet_inactive=function(e,n,i){"undefined"==typeof i&&(i=document);var r,o=new RegExp(e,"i");return t.each(i.styleSheets,function(e,t){if(t.href&&t.href.match(o))return t.disabled=n,r=t.disabled,!1}),r},this.create_front_page_iframe=function(){var i=t('<div class="hidden temp-container">');i.load(BoldgridEditor.site_url,function(r){return t("html").append('<iframe id="resizer-iframe" width="1600" height="600"></iframe>'),e.$resizing_iframe=t("#resizer-iframe"),i.find("script, meta, title").remove(),i.find("img").attr("src",""),i.find("[onload]").removeAttr("onload"),$stripped_without_styles=i.clone(),$stripped_without_styles.find("link, style").remove(),e.$resizing_iframe[0].contentWindow.document.write($stripped_without_styles.html()),$container=e.$resizing_iframe.contents().find('article[class^="post-"]').closest(".container, .container-fluid"),$container.hasClass("container")?e.bootstrap_container="container":$container.hasClass("container-fluid")&&(e.bootstrap_container="container-fluid"),e.$mce_iframe=t(tinymce.activeEditor.iframeElement),e.tinymce_body_container=e.$mce_iframe.contents().find("body"),e.bootstrap_container?(e.tinymce_body_container.addClass(e.bootstrap_container),e.$resizing_iframe.remove(),void n.trigger("resize")):(e.$resizing_iframe[0].src=BoldgridEditor.site_url,e.$resizing_iframe[0].onload=function(){e.$post_container=e.$resizing_iframe.contents().find('article[class^="post-"]'),n.trigger("resize")},void setTimeout(function(){"Microsoft Internet Explorer"==navigator.appName?window.frames[1].document.execCommand("Stop"):"function"==typeof window.frames[1].stop&&window.frames[1].stop()},3e3))})},this.resize_done_event=function(t,n){if(e.last_resize==t||n){var i=e.tinymce_body_container.closest("html"),r=e.tinymce_body_container;if(!e.bootstrap_container){if(!e.$post_container.width())return;e.$resizing_iframe.attr("width",i.width()),r.css("width",e.$post_container.width())}IMHWPB.Editor.instance.currently_selected_size?"monitor"==IMHWPB.Editor.instance.currently_selected_size?window.innerWidth>1470?o():window.innerWidth>1355?a():s():"tablet"==IMHWPB.Editor.instance.currently_selected_size?window.innerWidth>1250?o():window.innerWidth>1134?a():s():"phone"==IMHWPB.Editor.instance.currently_selected_size&&o():window.innerWidth>1470?o():window.innerWidth>1355?a():window.innerWidth>1041?s():window.innerWidth<=1040&&e.set_num_columns(2),e.update_device_highlighting(),e.refresh_iframe_height(),e.$window.trigger("resize.boldgrid-gallery")}};var o=function(){e.set_num_columns(2),e.$body.removeClass("folded"),e.$window.trigger("scroll")},a=function(){e.set_num_columns(2),e.$body.addClass("folded"),e.$window.trigger("scroll")},s=function(){e.set_num_columns(1),e.$body.addClass("folded"),e.$window.trigger("scroll")};this.set_num_columns=function(t){1==t?e.$post_body.addClass("columns-1").removeClass("columns-2"):e.$post_body.addClass("columns-2").removeClass("columns-1")},this.update_device_highlighting=function(){if(e.$mce_iframe&&!e.draggable_inactive){var t=e.$mce_iframe.width();t>1061?e.highlight_screen_size("desktop"):t>837?e.highlight_screen_size("tablet"):e.highlight_screen_size("phone")}},this.bind_collapse_click=function(){t("#collapse-menu").on("click",function(){IMHWPB.Editor.instance.currently_selected_size||window.innerWidth>1355&&window.innerWidth<1470&&(e.$body.hasClass("folded")?(e.set_num_columns(2),e.$window.trigger("scroll")):(e.set_num_columns(1),e.$window.trigger("scroll"))),e.update_device_highlighting()})},this.bind_column_switch=function(){t('[name="screen_columns"]').on("click",function(){e.update_device_highlighting()})},this.add_menu_item=function(e,t,n){i.push({title:e,element_type:t,callback:n})},this.edit_row=function(e,n){var i=t(n).find("p, a");i.length&&tinymce.activeEditor.selection.setCursorLocation(i[0],0)},this.bind_min_max_controls=function(){var n=t("#max-row-overlay"),i=t("#min-row-overlay");n.on("click",function(){e.$resize_div.animate({height:"1000px"},1e3)}),i.on("click",function(){e.$resize_div.animate({height:"0px"},1e3)})},this.create_resize_handle=function(){var n=t(".temp-overlay");e.$resize_div.resizable({handles:{n:t(".resizable-n")},start:function(e,t){n.addClass("active")},stop:function(e,t){n.removeClass("active")}}).bind("resize",function(e,n){t(this).css("top","auto")}).removeClass("ui-resizable")},t(function(){e.$window=t(window),e.$body=t("body"),e.$post_body=t("#post-body"),e.$editor_content_container=t("#poststuff"),e.$overlay_preview=t("#boldgrid-overlay-preview"),e.$resize_div=t("#resizable"),e.bind_column_switch(),e.create_front_page_iframe(),e.bind_window_resize(),e.bind_collapse_click(),e.bind_min_max_controls(),e.create_resize_handle()})};